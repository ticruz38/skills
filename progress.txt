## 2026-02-10 14:54 CET - US-004
- Created quickbooks-auth skill - QuickBooks OAuth for accounting integration
- Built on top of auth-provider skill for secure token management
- Implemented multi-profile support for multiple QuickBooks companies
- Added support for both sandbox and production environments
- Realm ID is stored in token metadata and accessible via getRealmId()
- Created QuickBooksAuthClient class with initiateAuth, completeAuth, isConnected, getAccessToken, healthCheck, fetch methods
- Implemented CLI with status, connect, complete, disconnect, health, profiles, env commands
- Type-safe environment handling with 'sandbox' | 'production' union type
- Files changed:
  - skills/quickbooks-auth/package.json
  - skills/quickbooks-auth/tsconfig.json
  - skills/quickbooks-auth/.gitignore
  - skills/quickbooks-auth/SKILL.md
  - skills/quickbooks-auth/src/index.ts
  - skills/quickbooks-auth/src/cli.ts
- **Learnings for future iterations:**
  - QuickBooks OAuth requires realmId to be captured from the callback URL and passed to completeAuth()
  - Realm ID is stored in metadata during completeAuth: `this.auth.completeAuth('quickbooks', code, state, { realmId, environment })`
  - Use `realmId || undefined` when returning to satisfy TypeScript's string | undefined type
  - QuickBooks API endpoints require both access token AND realmId in the URL path
  - getApiBaseUrl() returns different URLs for sandbox vs production
---

## 2026-02-10 14:48 CET - US-003
- Created binance-auth skill - Binance API key management for trading skills
- Built on top of auth-provider skill for secure credential storage
- Implemented multi-profile support for multiple Binance accounts
- Added support for both production and testnet environments
- Created BinanceAuthClient class with connect, disconnect, healthCheck, getBalance methods
- Implemented CLI with status, connect, health, list, validate, balance, disconnect commands
- API key validation checks for 64-character hex format
- Files changed:
  - skills/binance-auth/package.json
  - skills/binance-auth/tsconfig.json
  - skills/binance-auth/SKILL.md
  - skills/binance-auth/src/index.ts
  - skills/binance-auth/src/cli.ts
- **Learnings for future iterations:**
  - When auth-provider methods are async (getBinanceClient, getApiKey), need to await them
  - Can instantiate BinanceProviderAdapter directly with credentials for validation before storing
  - Use `await client.isConnected()` since it's now async (checks credentials from storage)
  - Filter non-zero balances with: `.filter((b: {free: string, locked: string}) => parseFloat(b.free) > 0 || parseFloat(b.locked) > 0)`
---

## 2026-02-10 15:29 CET - US-007
- Created calendar skill - Google Calendar integration for events and availability
- Built on top of google-oauth skill for authentication
- Implemented full Google Calendar API integration:
  - List events with time filters and pagination
  - Create events with attendees and recurrence rules
  - Update and delete events
  - Find free time slots using freeBusy API
  - Handle recurring events (RRULE format)
  - List user's calendars
  - Get single event details
  - Get upcoming events (next N days)
  - Get today's events
  - SQLite cache for events, calendars, and sync tokens
- Implemented CLI with all commands: status, calendars, list, get, create, update, delete, free, upcoming, today, health
- RecurrenceRule interface supports DAILY, WEEKLY, MONTHLY, YEARLY with interval, count, until, byDay, byMonthDay
- Free time finder merges overlapping busy periods and returns available slots of specified duration
- Typecheck passes
- Files changed:
  - skills/calendar/package.json (new)
  - skills/calendar/tsconfig.json (new)
  - skills/calendar/.gitignore (new)
  - skills/calendar/SKILL.md (new)
  - skills/calendar/src/index.ts (new)
  - skills/calendar/src/cli.ts (new)
- **Learnings for future iterations:**
  - Google Calendar API uses `calendars/{calendarId}/events` endpoint with calendarId URL-encoded
  - Free/busy API returns busy periods that need to be merged before calculating free slots
  - All-day events use `date` field instead of `dateTime`
  - Recurrence rules use RRULE format (e.g., "RRULE:FREQ=WEEKLY;BYDAY=MO,WE,FR")
  - CalendarListEntry has `primary` flag to identify the user's main calendar
  - Event start/end can be either date (all-day) or dateTime (timed) - check both
---

## Codebase Patterns
- Skills are TypeScript-based with `SKILL.md` documentation in frontmatter format
- Use `src/` directory for TypeScript source files
- Use `sqlite3` package (not better-sqlite3) for SQLite - better compatibility
- **sqlite3 import**: Use `import * as sqlite3 from 'sqlite3'` (not default import)
- Encrypt sensitive data with `crypto-js` AES
- Store credentials in `~/.openclaw/skills/{skill-name}/`
- Use environment variables for OAuth client credentials
- Provider adapters implement base interface for OAuth flows
- PKCE is used for all OAuth flows for security
- Multi-profile support via (provider, profile) unique key
- Skills that depend on other skills should use `"@openclaw/auth-provider": "file:../auth-provider"` in package.json
- When extending auth-provider interfaces, export new types (UserProfile) from types.ts
- Async methods in AuthProvider require await when called from dependent skills
- **Race condition prevention**: If using async initialization (like SQLite), ensure `close()` waits for init to complete before cleaning up resources

---

## 2026-02-10 14:56 CET - US-005
- Created slack-auth skill - Slack OAuth and bot token management for team communication
- Built on top of auth-provider skill for secure token management
- Implemented multi-profile support for multiple Slack workspaces
- Created SlackAuthClient class with initiateAuth, completeAuth, isConnected, getAccessToken, healthCheck, sendMessage, listChannels methods
- Implemented CLI with status, connect, complete, disconnect, health, profiles, test commands
- Added workspace info retrieval (team, user, URL) via auth.test API
- Added permission validation and token health checking
- Typecheck passes
- Files changed:
  - skills/slack-auth/package.json
  - skills/slack-auth/tsconfig.json
  - skills/slack-auth/.gitignore
  - skills/slack-auth/SKILL.md
  - skills/slack-auth/src/index.ts
  - skills/slack-auth/src/cli.ts
- **Learnings for future iterations:**
  - Slack OAuth uses comma-separated scopes (not space-separated like Google)
  - Slack tokens don't expire (no refresh needed), but we still validate via auth.test
  - Slack API returns `{ ok: boolean, error?: string }` format for all responses
  - AuthUrlResult type from auth-provider doesn't include scopes - must track separately if needed
  - Use `isConnected()` with await since it's async (checks credentials from storage)
  - Slack OAuth v2 returns both bot token and user token - we use the bot token

---

## 2026-02-10 14:35 CET - US-002
- Created google-oauth skill - Google OAuth adapter for Gmail, Calendar, Drive, Sheets, Docs
- Built on top of auth-provider skill for secure token management
- Replaced existing Python implementation with TypeScript
- Implemented multi-profile support for multiple Google accounts
- Added service-specific scope selection (gmail, calendar, drive, sheets, docs)
- Created CLI with status, connect, complete, disconnect, health, profiles, scopes commands
- Files changed:
  - skills/google-oauth/package.json
  - skills/google-oauth/tsconfig.json
  - skills/google-oauth/SKILL.md
  - skills/google-oauth/src/index.ts
  - skills/google-oauth/src/cli.ts
  - skills/auth-provider/src/types.ts (added UserProfile interface)
  - skills/auth-provider/src/index.ts (added deleteCredentials, listProfiles, getUserProfile)
- **Learnings for future iterations:**
  - Provider adapters can have optional methods like `getUserProfile?` for provider-specific features
  - Use `return token || null` to convert undefined to null for consistent return types
  - CLI commands that call async methods need to be async and use await
---

## 2026-02-10 14:16 CET - US-001
- Created auth-provider skill - foundation for all authentication
- Implemented OAuth 2.0 with PKCE flow
- Created encrypted SQLite storage with AES-256
- Implemented provider adapters: Google, Binance (API key), QuickBooks, Slack
- Added auto-refresh for expiring tokens
- Added health check endpoint for all credentials
- Created CLI for credential management
- Files changed:
  - skills/auth-provider/package.json
  - skills/auth-provider/tsconfig.json
  - skills/auth-provider/SKILL.md
  - skills/auth-provider/src/types.ts
  - skills/auth-provider/src/storage.ts
  - skills/auth-provider/src/index.ts
  - skills/auth-provider/src/cli.ts
  - skills/auth-provider/src/providers/base.ts
  - skills/auth-provider/src/providers/google.ts
  - skills/auth-provider/src/providers/binance.ts
  - skills/auth-provider/src/providers/quickbooks.ts
  - skills/auth-provider/src/providers/slack.ts
  - skills/auth-provider/src/providers/index.ts
- **Learnings for future iterations:**
  - Use `sqlite3` with serialize() for schema initialization to avoid SQLITE_MISUSE
  - Use `crypto-js` for AES encryption - pure JS, no native dependencies
  - Provider adapters should have flexible validateToken signature for provider-specific params
  - Use `fetch` API with explicit type casting: `await response.json() as Type`
  - Store node_modules in .gitignore - don't commit dependencies
---
---

## 2026-02-10 15:28 CET - US-006
- Created email skill - Gmail integration for reading, sending, and managing emails
- Built on top of google-oauth skill for authentication
- Implemented full Gmail API integration with the following features:
  - List emails with pagination
  - Search using Gmail query syntax (from:, to:, is:unread, has:attachment, etc.)
  - Read full email content with text and HTML bodies
  - Send emails with support for CC, BCC, attachments
  - Reply to emails with automatic threading
  - Thread view to see all messages in a conversation
  - Mark as read/unread, star/unstar, archive, trash, delete
  - Download attachments
  - List Gmail labels
  - SQLite cache for email metadata
  - Full CLI with all commands
- TypeScript implementation following codebase patterns
- Replaced old Python implementation
- Typecheck passes
- Files changed:
  - skills/email/package.json (new)
  - skills/email/tsconfig.json (new)
  - skills/email/.gitignore (new)
  - skills/email/SKILL.md (updated)
  - skills/email/src/index.ts (new)
  - skills/email/src/cli.ts (new)
  - skills/email/email.py (deleted)
  - skills/email/onboard.yaml (deleted)
  - skills/email/requirements.txt (deleted)
- **Learnings for future iterations:**
  - sqlite3 module doesn't have a default export - use `import * as sqlite3 from 'sqlite3'`
  - Always wait for database initialization before closing to avoid race conditions
  - Use `new sqlite3.Database(path, callback)` pattern with Promise wrapper for async/await
  - When using `enableCache` with async initialization, ensure `close()` waits for initPromise
  - Gmail API returns base64url encoded data for attachments
  - Email threads use the same threadId across all messages in the conversation
  - Gmail API uses `users/me/messages` endpoint with OAuth authentication
  - The `run()` promisified helper must check if db is null before calling db.run()
## Codebase Patterns
- Skills are TypeScript-based with `SKILL.md` documentation in frontmatter format
- Use `src/` directory for TypeScript source files
- Use `sqlite3` package (not better-sqlite3) for SQLite - better compatibility
- **sqlite3 import**: Use `import * as sqlite3 from 'sqlite3'` (not default import)
- Encrypt sensitive data with `crypto-js` AES
- Store credentials in `~/.openclaw/skills/{skill-name}/`
- Use environment variables for OAuth client credentials
- Provider adapters implement base interface for OAuth flows
- PKCE is used for all OAuth flows for security
- Multi-profile support via (provider, profile) unique key
- Skills that depend on other skills should use `"@openclaw/auth-provider": "file:../auth-provider"` in package.json
- When extending auth-provider interfaces, export new types (UserProfile) from types.ts
- Async methods in AuthProvider require await when called from dependent skills
- **Race condition prevention**: If using async initialization (like SQLite), ensure `close()` waits for init to complete before cleaning up resources
- **SQLite run result**: To get `lastID` after INSERT, use a custom promisified wrapper that captures `this.lastID` from the callback:
  ```typescript
  function runWithResult(db: sqlite3.Database, sql: string, params: any[] = []): Promise<{ lastID: number; changes: number }> {
    return new Promise((resolve, reject) => {
      db.run(sql, params, function(this: sqlite3.RunResult, err: Error | null) {
        if (err) reject(err);
        else resolve({ lastID: this.lastID, changes: this.changes });
      });
    });
  }
  ```

## 2026-02-10 15:34 CET - US-008
- Created reminders skill - Local reminder system with scheduling and notifications
- Implemented full TypeScript replacement of the old Python implementation:
  - One-time reminders with flexible datetime parsing
  - Recurring reminders (daily, weekly, monthly)
  - Natural language parsing for dates: "in 2 hours", "tomorrow", "14:30", "in 30 minutes"
  - Snooze functionality for temporarily dismissing reminders
  - Complete/delete reminders with history tracking
  - Daemon mode for cron/systemd integration to check for due reminders
  - SQLite storage with separate tables for active reminders and completed history
- Created RemindersSkill class with full API:
  - addReminder(), addRecurringReminder() for creating reminders
  - listReminders(), getDueReminders(), getReminder() for querying
  - completeReminder(), snoozeReminder(), deleteReminder() for actions
  - parseNaturalDateTime() for natural language datetime parsing
  - healthCheck(), getStats(), daemonCheck() for monitoring
- Implemented comprehensive CLI with all commands:
  - add, recurring, list, due, get, complete, snooze, delete
  - history, stats, daemon, health, parse (test parsing)
- Typecheck passes
- No external dependencies - works entirely offline with local SQLite
- Files changed:
  - skills/reminders/package.json (new)
  - skills/reminders/tsconfig.json (new)
  - skills/reminders/.gitignore (new)
  - skills/reminders/SKILL.md (updated - converted to TypeScript)
  - skills/reminders/src/index.ts (new - main library)
  - skills/reminders/src/cli.ts (new - CLI interface)
  - skills/reminders/reminders.py (deleted - old Python implementation)
- **Learnings for future iterations:**
  - SQLite3's `run()` method returns the Database instance, not the RunResult
  - To get `lastID` after INSERT, must use the callback's `this` context
  - Create a `runWithResult()` helper that captures `this.lastID` and `this.changes`
  - Natural language parsing can be done locally with regex patterns - no external API needed
  - Daemon mode should output JSON for easy integration with notification systems
  - For recurring reminders, completing them should calculate and set the next occurrence
  - Use ISO strings for datetime storage in SQLite for consistency
---

## 2026-02-10 15:40 CET - US-009
- Created meetings skill - Coordinate meetings using calendar and email
- Built on top of calendar and email skills for seamless integration
- Implemented meeting coordination features:
  - Find mutual availability using calendar's free/busy API
  - Schedule meetings with automatic calendar event creation
  - Send meeting invite emails to all attendees
  - Send prep emails with agenda and materials
- Implemented meeting management:
  - Create, update, cancel, and delete meetings
  - List meetings with filtering by status and date range
  - Get detailed meeting information
  - SQLite storage for meeting records and templates
- Implemented meeting templates system:
  - 5 default templates: Standup, Sprint Planning, 1-on-1, Retrospective, Review
  - Template database with agenda items and prep documents
  - Schedule meetings from templates with one command
- Implemented agenda management:
  - Structured agenda items with time allocations
  - Automatic agenda text generation for calendar events
  - Prep documents tracking
- Created comprehensive CLI with commands:
  - schedule, quick, template - Meeting creation options
  - list, get, cancel, delete - Meeting management
  - templates - List available templates
  - free - Find available time slots
  - invite, prep - Send emails
  - status, health - Connection checks
- TypeScript implementation following all codebase patterns
- Typecheck passes
- Files changed:
  - skills/meetings/package.json (new)
  - skills/meetings/tsconfig.json (new)
  - skills/meetings/.gitignore (new)
  - skills/meetings/SKILL.md (new)
  - skills/meetings/src/index.ts (new)
  - skills/meetings/src/cli.ts (new)
- **Learnings for future iterations:**
  - Skills can depend on multiple other skills (calendar + email)
  - Use file: dependencies in package.json for local skill dependencies
  - Template system allows users to quickly schedule common meeting types
  - Prep emails are separate from invites - allows sending materials in advance
  - SQLite storage pattern is consistent across all skills
  - When using multiple skills, remember to close all connections in cleanup
  - Meeting status tracks lifecycle: draft → scheduled → cancelled/completed
  - Calendar event IDs are stored for bidirectional sync
---


## 2026-02-10 15:50 CET - US-010
- Created slack skill - Send messages and notifications to Slack channels
- Built on top of slack-auth skill for authentication
- Implemented comprehensive messaging features:
  - Send messages to channels with rich formatting (blocks, attachments)
  - Send direct messages to users
  - Reply in threads
  - Upload files to channels
  - Create and manage channels (public/private)
  - Join and leave channels
  - List channels and users
  - Get user info by ID or email
- Implemented notification template system:
  - Create reusable templates with variable substitution
  - Templates stored in SQLite with blocks/attachments support
  - Variable syntax: {{variableName}}
  - Template CRUD operations
- SQLite storage for:
  - Notification templates with metadata
  - Sent message history for auditing
- TypeScript implementation following all codebase patterns
- Typecheck passes
- Files changed:
  - skills/slack/package.json (new)
  - skills/slack/tsconfig.json (new)
  - skills/slack/.gitignore (new)
  - skills/slack/SKILL.md (new)
  - skills/slack/src/index.ts (new)
  - skills/slack/src/cli.ts (new)
- **Learnings for future iterations:**
  - Use `new (sqlite3 as any).Database(path)` pattern for sqlite3 in ES modules
  - For FormData file uploads in Node.js, need to use Blob with fetch
  - Slack conversations API uses `conversations.list` for channels (not channels.list)
  - Private channels use `conversations.create` with `is_private: true`
  - Template variables use regex replacement: `new RegExp('{{\\s*key\\s*}}', 'g')`
  - When serializing blocks for variable substitution, stringify → replace → parse
  - Slack API uses `thread_ts` for thread replies (not `threadTs` in API calls)
---

