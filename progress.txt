## 2026-02-10 14:54 CET - US-004
- Created quickbooks-auth skill - QuickBooks OAuth for accounting integration
- Built on top of auth-provider skill for secure token management
- Implemented multi-profile support for multiple QuickBooks companies
- Added support for both sandbox and production environments
- Realm ID is stored in token metadata and accessible via getRealmId()
- Created QuickBooksAuthClient class with initiateAuth, completeAuth, isConnected, getAccessToken, healthCheck, fetch methods
- Implemented CLI with status, connect, complete, disconnect, health, profiles, env commands
- Type-safe environment handling with 'sandbox' | 'production' union type
- Files changed:
  - skills/quickbooks-auth/package.json
  - skills/quickbooks-auth/tsconfig.json
  - skills/quickbooks-auth/.gitignore
  - skills/quickbooks-auth/SKILL.md
  - skills/quickbooks-auth/src/index.ts
  - skills/quickbooks-auth/src/cli.ts
- **Learnings for future iterations:**
  - QuickBooks OAuth requires realmId to be captured from the callback URL and passed to completeAuth()
  - Realm ID is stored in metadata during completeAuth: `this.auth.completeAuth('quickbooks', code, state, { realmId, environment })`
  - Use `realmId || undefined` when returning to satisfy TypeScript's string | undefined type
  - QuickBooks API endpoints require both access token AND realmId in the URL path
  - getApiBaseUrl() returns different URLs for sandbox vs production
---

## 2026-02-10 14:48 CET - US-003
- Created binance-auth skill - Binance API key management for trading skills
- Built on top of auth-provider skill for secure credential storage
- Implemented multi-profile support for multiple Binance accounts
- Added support for both production and testnet environments
- Created BinanceAuthClient class with connect, disconnect, healthCheck, getBalance methods
- Implemented CLI with status, connect, health, list, validate, balance, disconnect commands
- API key validation checks for 64-character hex format
- Files changed:
  - skills/binance-auth/package.json
  - skills/binance-auth/tsconfig.json
  - skills/binance-auth/SKILL.md
  - skills/binance-auth/src/index.ts
  - skills/binance-auth/src/cli.ts
- **Learnings for future iterations:**
  - When auth-provider methods are async (getBinanceClient, getApiKey), need to await them
  - Can instantiate BinanceProviderAdapter directly with credentials for validation before storing
  - Use `await client.isConnected()` since it's now async (checks credentials from storage)
  - Filter non-zero balances with: `.filter((b: {free: string, locked: string}) => parseFloat(b.free) > 0 || parseFloat(b.locked) > 0)`
---

## 2026-02-10 15:29 CET - US-007
- Created calendar skill - Google Calendar integration for events and availability
- Built on top of google-oauth skill for authentication
- Implemented full Google Calendar API integration:
  - List events with time filters and pagination
  - Create events with attendees and recurrence rules
  - Update and delete events
  - Find free time slots using freeBusy API
  - Handle recurring events (RRULE format)
  - List user's calendars
  - Get single event details
  - Get upcoming events (next N days)
  - Get today's events
  - SQLite cache for events, calendars, and sync tokens
- Implemented CLI with all commands: status, calendars, list, get, create, update, delete, free, upcoming, today, health
- RecurrenceRule interface supports DAILY, WEEKLY, MONTHLY, YEARLY with interval, count, until, byDay, byMonthDay
- Free time finder merges overlapping busy periods and returns available slots of specified duration
- Typecheck passes
- Files changed:
  - skills/calendar/package.json (new)
  - skills/calendar/tsconfig.json (new)
  - skills/calendar/.gitignore (new)
  - skills/calendar/SKILL.md (new)
  - skills/calendar/src/index.ts (new)
  - skills/calendar/src/cli.ts (new)
- **Learnings for future iterations:**
  - Google Calendar API uses `calendars/{calendarId}/events` endpoint with calendarId URL-encoded
  - Free/busy API returns busy periods that need to be merged before calculating free slots
  - All-day events use `date` field instead of `dateTime`
  - Recurrence rules use RRULE format (e.g., "RRULE:FREQ=WEEKLY;BYDAY=MO,WE,FR")
  - CalendarListEntry has `primary` flag to identify the user's main calendar
  - Event start/end can be either date (all-day) or dateTime (timed) - check both
---

## Codebase Patterns
- Skills are TypeScript-based with `SKILL.md` documentation in frontmatter format
- Use `src/` directory for TypeScript source files
- Use `sqlite3` package (not better-sqlite3) for SQLite - better compatibility
- **sqlite3 import**: Use `import * as sqlite3 from 'sqlite3'` (not default import)
- Encrypt sensitive data with `crypto-js` AES
- Store credentials in `~/.openclaw/skills/{skill-name}/`
- Use environment variables for OAuth client credentials
- Provider adapters implement base interface for OAuth flows
- PKCE is used for all OAuth flows for security
- Multi-profile support via (provider, profile) unique key
- Skills that depend on other skills should use `"@openclaw/auth-provider": "file:../auth-provider"` in package.json
- When extending auth-provider interfaces, export new types (UserProfile) from types.ts
- Async methods in AuthProvider require await when called from dependent skills
- **Race condition prevention**: If using async initialization (like SQLite), ensure `close()` waits for init to complete before cleaning up resources

---

## 2026-02-10 14:56 CET - US-005
- Created slack-auth skill - Slack OAuth and bot token management for team communication
- Built on top of auth-provider skill for secure token management
- Implemented multi-profile support for multiple Slack workspaces
- Created SlackAuthClient class with initiateAuth, completeAuth, isConnected, getAccessToken, healthCheck, sendMessage, listChannels methods
- Implemented CLI with status, connect, complete, disconnect, health, profiles, test commands
- Added workspace info retrieval (team, user, URL) via auth.test API
- Added permission validation and token health checking
- Typecheck passes
- Files changed:
  - skills/slack-auth/package.json
  - skills/slack-auth/tsconfig.json
  - skills/slack-auth/.gitignore
  - skills/slack-auth/SKILL.md
  - skills/slack-auth/src/index.ts
  - skills/slack-auth/src/cli.ts
- **Learnings for future iterations:**
  - Slack OAuth uses comma-separated scopes (not space-separated like Google)
  - Slack tokens don't expire (no refresh needed), but we still validate via auth.test
  - Slack API returns `{ ok: boolean, error?: string }` format for all responses
  - AuthUrlResult type from auth-provider doesn't include scopes - must track separately if needed
  - Use `isConnected()` with await since it's async (checks credentials from storage)
  - Slack OAuth v2 returns both bot token and user token - we use the bot token

---

## 2026-02-10 14:35 CET - US-002
- Created google-oauth skill - Google OAuth adapter for Gmail, Calendar, Drive, Sheets, Docs
- Built on top of auth-provider skill for secure token management
- Replaced existing Python implementation with TypeScript
- Implemented multi-profile support for multiple Google accounts
- Added service-specific scope selection (gmail, calendar, drive, sheets, docs)
- Created CLI with status, connect, complete, disconnect, health, profiles, scopes commands
- Files changed:
  - skills/google-oauth/package.json
  - skills/google-oauth/tsconfig.json
  - skills/google-oauth/SKILL.md
  - skills/google-oauth/src/index.ts
  - skills/google-oauth/src/cli.ts
  - skills/auth-provider/src/types.ts (added UserProfile interface)
  - skills/auth-provider/src/index.ts (added deleteCredentials, listProfiles, getUserProfile)
- **Learnings for future iterations:**
  - Provider adapters can have optional methods like `getUserProfile?` for provider-specific features
  - Use `return token || null` to convert undefined to null for consistent return types
  - CLI commands that call async methods need to be async and use await
---

## 2026-02-10 14:16 CET - US-001
- Created auth-provider skill - foundation for all authentication
- Implemented OAuth 2.0 with PKCE flow
- Created encrypted SQLite storage with AES-256
- Implemented provider adapters: Google, Binance (API key), QuickBooks, Slack
- Added auto-refresh for expiring tokens
- Added health check endpoint for all credentials
- Created CLI for credential management
- Files changed:
  - skills/auth-provider/package.json
  - skills/auth-provider/tsconfig.json
  - skills/auth-provider/SKILL.md
  - skills/auth-provider/src/types.ts
  - skills/auth-provider/src/storage.ts
  - skills/auth-provider/src/index.ts
  - skills/auth-provider/src/cli.ts
  - skills/auth-provider/src/providers/base.ts
  - skills/auth-provider/src/providers/google.ts
  - skills/auth-provider/src/providers/binance.ts
  - skills/auth-provider/src/providers/quickbooks.ts
  - skills/auth-provider/src/providers/slack.ts
  - skills/auth-provider/src/providers/index.ts
- **Learnings for future iterations:**
  - Use `sqlite3` with serialize() for schema initialization to avoid SQLITE_MISUSE
  - Use `crypto-js` for AES encryption - pure JS, no native dependencies
  - Provider adapters should have flexible validateToken signature for provider-specific params
  - Use `fetch` API with explicit type casting: `await response.json() as Type`
  - Store node_modules in .gitignore - don't commit dependencies
---
---

## 2026-02-10 15:28 CET - US-006
- Created email skill - Gmail integration for reading, sending, and managing emails
- Built on top of google-oauth skill for authentication
- Implemented full Gmail API integration with the following features:
  - List emails with pagination
  - Search using Gmail query syntax (from:, to:, is:unread, has:attachment, etc.)
  - Read full email content with text and HTML bodies
  - Send emails with support for CC, BCC, attachments
  - Reply to emails with automatic threading
  - Thread view to see all messages in a conversation
  - Mark as read/unread, star/unstar, archive, trash, delete
  - Download attachments
  - List Gmail labels
  - SQLite cache for email metadata
  - Full CLI with all commands
- TypeScript implementation following codebase patterns
- Replaced old Python implementation
- Typecheck passes
- Files changed:
  - skills/email/package.json (new)
  - skills/email/tsconfig.json (new)
  - skills/email/.gitignore (new)
  - skills/email/SKILL.md (updated)
  - skills/email/src/index.ts (new)
  - skills/email/src/cli.ts (new)
  - skills/email/email.py (deleted)
  - skills/email/onboard.yaml (deleted)
  - skills/email/requirements.txt (deleted)
- **Learnings for future iterations:**
  - sqlite3 module doesn't have a default export - use `import * as sqlite3 from 'sqlite3'`
  - Always wait for database initialization before closing to avoid race conditions
  - Use `new sqlite3.Database(path, callback)` pattern with Promise wrapper for async/await
  - When using `enableCache` with async initialization, ensure `close()` waits for initPromise
  - Gmail API returns base64url encoded data for attachments
  - Email threads use the same threadId across all messages in the conversation
  - Gmail API uses `users/me/messages` endpoint with OAuth authentication
  - The `run()` promisified helper must check if db is null before calling db.run()
## Codebase Patterns
- Skills are TypeScript-based with `SKILL.md` documentation in frontmatter format
- Use `src/` directory for TypeScript source files
- Use `sqlite3` package (not better-sqlite3) for SQLite - better compatibility
- **sqlite3 import**: Use `import * as sqlite3 from 'sqlite3'` (not default import)
- Encrypt sensitive data with `crypto-js` AES
- Store credentials in `~/.openclaw/skills/{skill-name}/`
- Use environment variables for OAuth client credentials
- Provider adapters implement base interface for OAuth flows
- PKCE is used for all OAuth flows for security
- Multi-profile support via (provider, profile) unique key
- Skills that depend on other skills should use `"@openclaw/auth-provider": "file:../auth-provider"` in package.json
- When extending auth-provider interfaces, export new types (UserProfile) from types.ts
- Async methods in AuthProvider require await when called from dependent skills
- **Race condition prevention**: If using async initialization (like SQLite), ensure `close()` waits for init to complete before cleaning up resources
- **SQLite run result**: To get `lastID` after INSERT, use a custom promisified wrapper that captures `this.lastID` from the callback:
  ```typescript
  function runWithResult(db: sqlite3.Database, sql: string, params: any[] = []): Promise<{ lastID: number; changes: number }> {
    return new Promise((resolve, reject) => {
      db.run(sql, params, function(this: sqlite3.RunResult, err: Error | null) {
        if (err) reject(err);
        else resolve({ lastID: this.lastID, changes: this.changes });
      });
    });
  }
  ```

## 2026-02-10 15:34 CET - US-008
- Created reminders skill - Local reminder system with scheduling and notifications
- Implemented full TypeScript replacement of the old Python implementation:
  - One-time reminders with flexible datetime parsing
  - Recurring reminders (daily, weekly, monthly)
  - Natural language parsing for dates: "in 2 hours", "tomorrow", "14:30", "in 30 minutes"
  - Snooze functionality for temporarily dismissing reminders
  - Complete/delete reminders with history tracking
  - Daemon mode for cron/systemd integration to check for due reminders
  - SQLite storage with separate tables for active reminders and completed history
- Created RemindersSkill class with full API:
  - addReminder(), addRecurringReminder() for creating reminders
  - listReminders(), getDueReminders(), getReminder() for querying
  - completeReminder(), snoozeReminder(), deleteReminder() for actions
  - parseNaturalDateTime() for natural language datetime parsing
  - healthCheck(), getStats(), daemonCheck() for monitoring
- Implemented comprehensive CLI with all commands:
  - add, recurring, list, due, get, complete, snooze, delete
  - history, stats, daemon, health, parse (test parsing)
- Typecheck passes
- No external dependencies - works entirely offline with local SQLite
- Files changed:
  - skills/reminders/package.json (new)
  - skills/reminders/tsconfig.json (new)
  - skills/reminders/.gitignore (new)
  - skills/reminders/SKILL.md (updated - converted to TypeScript)
  - skills/reminders/src/index.ts (new - main library)
  - skills/reminders/src/cli.ts (new - CLI interface)
  - skills/reminders/reminders.py (deleted - old Python implementation)
- **Learnings for future iterations:**
  - SQLite3's `run()` method returns the Database instance, not the RunResult
  - To get `lastID` after INSERT, must use the callback's `this` context
  - Create a `runWithResult()` helper that captures `this.lastID` and `this.changes`
  - Natural language parsing can be done locally with regex patterns - no external API needed
  - Daemon mode should output JSON for easy integration with notification systems
  - For recurring reminders, completing them should calculate and set the next occurrence
  - Use ISO strings for datetime storage in SQLite for consistency
---

## 2026-02-10 15:40 CET - US-009
- Created meetings skill - Coordinate meetings using calendar and email
- Built on top of calendar and email skills for seamless integration
- Implemented meeting coordination features:
  - Find mutual availability using calendar's free/busy API
  - Schedule meetings with automatic calendar event creation
  - Send meeting invite emails to all attendees
  - Send prep emails with agenda and materials
- Implemented meeting management:
  - Create, update, cancel, and delete meetings
  - List meetings with filtering by status and date range
  - Get detailed meeting information
  - SQLite storage for meeting records and templates
- Implemented meeting templates system:
  - 5 default templates: Standup, Sprint Planning, 1-on-1, Retrospective, Review
  - Template database with agenda items and prep documents
  - Schedule meetings from templates with one command
- Implemented agenda management:
  - Structured agenda items with time allocations
  - Automatic agenda text generation for calendar events
  - Prep documents tracking
- Created comprehensive CLI with commands:
  - schedule, quick, template - Meeting creation options
  - list, get, cancel, delete - Meeting management
  - templates - List available templates
  - free - Find available time slots
  - invite, prep - Send emails
  - status, health - Connection checks
- TypeScript implementation following all codebase patterns
- Typecheck passes
- Files changed:
  - skills/meetings/package.json (new)
  - skills/meetings/tsconfig.json (new)
  - skills/meetings/.gitignore (new)
  - skills/meetings/SKILL.md (new)
  - skills/meetings/src/index.ts (new)
  - skills/meetings/src/cli.ts (new)
- **Learnings for future iterations:**
  - Skills can depend on multiple other skills (calendar + email)
  - Use file: dependencies in package.json for local skill dependencies
  - Template system allows users to quickly schedule common meeting types
  - Prep emails are separate from invites - allows sending materials in advance
  - SQLite storage pattern is consistent across all skills
  - When using multiple skills, remember to close all connections in cleanup
  - Meeting status tracks lifecycle: draft → scheduled → cancelled/completed
  - Calendar event IDs are stored for bidirectional sync
---


## 2026-02-10 15:50 CET - US-010
- Created slack skill - Send messages and notifications to Slack channels
- Built on top of slack-auth skill for authentication
- Implemented comprehensive messaging features:
  - Send messages to channels with rich formatting (blocks, attachments)
  - Send direct messages to users
  - Reply in threads
  - Upload files to channels
  - Create and manage channels (public/private)
  - Join and leave channels
  - List channels and users
  - Get user info by ID or email
- Implemented notification template system:
  - Create reusable templates with variable substitution
  - Templates stored in SQLite with blocks/attachments support
  - Variable syntax: {{variableName}}
  - Template CRUD operations
- SQLite storage for:
  - Notification templates with metadata
  - Sent message history for auditing
- TypeScript implementation following all codebase patterns
- Typecheck passes
- Files changed:
  - skills/slack/package.json (new)
  - skills/slack/tsconfig.json (new)
  - skills/slack/.gitignore (new)
  - skills/slack/SKILL.md (new)
  - skills/slack/src/index.ts (new)
  - skills/slack/src/cli.ts (new)
- **Learnings for future iterations:**
  - Use `new (sqlite3 as any).Database(path)` pattern for sqlite3 in ES modules
  - For FormData file uploads in Node.js, need to use Blob with fetch
  - Slack conversations API uses `conversations.list` for channels (not channels.list)
  - Private channels use `conversations.create` with `is_private: true`
  - Template variables use regex replacement: `new RegExp('{{\\s*key\\s*}}', 'g')`
  - When serializing blocks for variable substitution, stringify → replace → parse
  - Slack API uses `thread_ts` for thread replies (not `threadTs` in API calls)
---


## 2026-02-10 15:50 CET - US-011
- Created binance skill - Trade and monitor crypto via Binance API
- Built on top of binance-auth skill for secure authentication
- Implemented comprehensive trading features:
  - Real-time price fetching (single symbol, multiple symbols, all prices)
  - 24hr ticker statistics with price changes, volume, high/low
  - Account balance viewing (all assets or specific asset)
  - Order management: market orders, limit orders, order status, cancel orders
  - Order history and trade history retrieval
  - Candlestick/Kline data for technical analysis
  - Exchange information and symbol details
- Implemented local SQLite storage for:
  - Trade records with order details, status, commission
  - Price history tracking
  - Notes support for trades
- Implemented comprehensive CLI with commands:
  - status, health, env - Connection monitoring
  - price, prices, ticker, symbols, info, klines - Market data
  - balance - Account balances
  - buy, sell, limit-buy, limit-sell - Trading
  - order, cancel, open, history - Order management
  - trades, note - Local trade history
- TypeScript implementation following all codebase patterns
- Typecheck passes
- Files changed:
  - skills/binance/package.json (new)
  - skills/binance/tsconfig.json (new)
  - skills/binance/.gitignore (new)
  - skills/binance/SKILL.md (new)
  - skills/binance/src/index.ts (new)
  - skills/binance/src/cli.ts (new)
- **Learnings for future iterations:**
  - When building skills on top of auth-provider adapters, check what methods are available
  - The BinanceProviderAdapter has `request()` method for GET/POST but only supports those methods
  - For DELETE requests (like cancel order), implement a custom `signedRequest()` method
  - Binance API uses HMAC-SHA256 signature with timestamp and query parameters
  - Use `crypto.createHmac('sha256', secret).update(query).digest('hex')` for signatures
  - For SQLite column names with camelCase in TypeScript, use snake_case in the database
  - Store price history automatically when fetching prices for trend analysis
---

## 2026-02-10 15:56 CET - US-012
- Created alerts skill - Monitor prices and send notifications
- Built on top of binance and slack skills for price data and notifications
- Implemented two types of alerts:
  - Threshold alerts: Trigger when price goes above or below a specific value
  - Percentage change alerts: Trigger when price changes by a percentage within a timeframe
- Features implemented:
  - Price threshold alerts (above/below conditions)
  - Percentage change alerts with configurable direction (up/down/both)
  - Multi-channel notifications (console, Slack)
  - Alert history stored in SQLite with full trigger details
  - Batch checking of all alerts with detailed results
  - Enable/disable/pause alerts
  - Statistics tracking (trigger counts, active alerts)
  - Full CLI with all commands
- SQLite storage for:
  - threshold_alerts table with trigger tracking
  - percentage_alerts table with last price tracking for change calculation
  - alert_history table for audit trail
- Dynamic import for Slack skill to handle ES module compatibility
- Typecheck passes
- Files changed:
  - skills/alerts/package.json (new)
  - skills/alerts/tsconfig.json (new)
  - skills/alerts/.gitignore (new)
  - skills/alerts/SKILL.md (new)
  - skills/alerts/src/index.ts (new)
  - skills/alerts/src/cli.ts (new)
- **Learnings for future iterations:**
  - When depending on ES module skills from CommonJS, use dynamic imports
  - For percentage alerts, store last_price to calculate changes over time
  - Alert history provides valuable audit trail for triggered notifications
  - Use JSON.stringify/parse for storing arrays (channels) in SQLite
  - Batch notifications by collecting all triggered alerts and sending together
  - Skills can depend on multiple other skills (binance + slack)
---

## Codebase Patterns
- Skills are TypeScript-based with `SKILL.md` documentation in frontmatter format
- Use `src/` directory for TypeScript source files
- Use `sqlite3` package (not better-sqlite3) for SQLite - better compatibility
- **sqlite3 import**: Use `import * as sqlite3 from 'sqlite3'` (not default import)
- Encrypt sensitive data with `crypto-js` AES
- Store credentials in `~/.openclaw/skills/{skill-name}/`
- Use environment variables for OAuth client credentials
- Provider adapters implement base interface for OAuth flows
- PKCE is used for all OAuth flows for security
- Multi-profile support via (provider, profile) unique key
- Skills that depend on other skills should use `"@openclaw/auth-provider": "file:../auth-provider"` in package.json
- When extending auth-provider interfaces, export new types (UserProfile) from types.ts
- Async methods in AuthProvider require await when called from dependent skills
- **Race condition prevention**: If using async initialization (like SQLite), ensure `close()` waits for init to complete before cleaning up resources
- **Dynamic imports for ES modules**: When a dependency skill uses ES modules (type: module), use dynamic import() with async/await instead of static import

## Codebase Patterns
- Skills are TypeScript-based with `SKILL.md` documentation in frontmatter format
- Use `src/` directory for TypeScript source files
- Use `sqlite3` package (not better-sqlite3) for SQLite - better compatibility
- **sqlite3 import**: Use `import * as sqlite3 from 'sqlite3'` (not default import)
- Encrypt sensitive data with `crypto-js` AES
- Store credentials in `~/.openclaw/skills/{skill-name}/`
- Use environment variables for OAuth client credentials
- Provider adapters implement base interface for OAuth flows
- PKCE is used for all OAuth flows for security
- Multi-profile support via (provider, profile) unique key
- Skills that depend on other skills should use `"@openclaw/auth-provider": "file:../auth-provider"` in package.json
- When extending auth-provider interfaces, export new types (UserProfile) from types.ts
- Async methods in AuthProvider require await when called from dependent skills
- **Race condition prevention**: If using async initialization (like SQLite), ensure `close()` waits for init to complete before cleaning up resources
- **SQLite run result**: To get `lastID` after INSERT, use a custom promisified wrapper that captures `this.lastID` from the callback:
  ```typescript
  function runWithResult(db: sqlite3.Database, sql: string, params: any[] = []): Promise<{ lastID: number; changes: number }> {
    return new Promise((resolve, reject) => {
      db.run(sql, params, function(this: sqlite3.RunResult, err: Error | null) {
        if (err) reject(err);
        else resolve({ lastID: this.lastID, changes: this.changes });
      });
    });
  }
  ```
- **Dynamic imports for ES modules**: When a dependency skill uses ES modules (type: module), use dynamic import() with async/await instead of static import

---

## 2026-02-10 16:01 CET - US-013
- Created portfolio skill - Track crypto portfolio positions with P&L and allocation
- Built on top of binance skill for price data and balance syncing
- Implemented comprehensive portfolio tracking features:
  - Position tracking with average cost basis calculation
  - Real-time P&L calculation using current prices from Binance
  - Allocation breakdown with percentage calculations
  - Historical performance tracking via snapshots
  - Trade recording for accurate cost basis (BUY/SELL with fees)
  - CSV export for portfolio data
  - ASCII allocation and performance charts
  - Binance sync to import current holdings
- Database schema:
  - positions table: tracks quantity, average_cost, total_cost, realized_pnl
  - trades table: records all BUY/SELL transactions
  - portfolio_snapshots table: historical portfolio values
- Cost basis calculation uses average cost method:
  - Buys add to quantity and recalculate average cost
  - Sells realize P&L based on average cost, reduce quantity
- Typecheck passes
- Files changed:
  - skills/portfolio/package.json (new)
  - skills/portfolio/tsconfig.json (new)
  - skills/portfolio/.gitignore (new)
  - skills/portfolio/SKILL.md (new)
  - skills/portfolio/src/index.ts (new)
  - skills/portfolio/src/cli.ts (new)
  - .gitignore (updated to exclude logs/)
- **Learnings for future iterations:**
  - Cost basis tracking requires storing both average_cost AND total_cost for accuracy
  - Realized P&L must be tracked separately from unrealized P&L
  - When syncing from exchange, use current price as cost basis if position is new
  - For price lookups, try USDT pair first, then BTC pair as fallback
  - CSV export should include both detailed positions and summary data
  - ASCII charts use Unicode block characters for visualization
  - Portfolio snapshots enable historical performance tracking over time
---


## 2026-02-10 16:05 CET - US-014
- Created charts skill - Generate price charts and technical overlays for crypto trading
- Built on top of binance skill for price data (klines/candlestick data)
- Implemented comprehensive chart generation features:
  - Line charts with gradient fills and current price indicator
  - Candlestick charts with OHLC data and volume overlay
  - Multiple timeframe support: 1m, 5m, 15m, 30m, 1h, 4h, 1d, 1w, 1M
  - Moving averages (SMA) with configurable periods and multiple MA support
  - Volume bars on candlestick charts with up/down coloring
  - Light and dark themes with customizable colors
  - SVG export (pure JavaScript, no native dependencies)
- ChartsSkill class provides:
  - generateLineChart() - Simple price line with optional MAs
  - generateCandlestickChart() - Full OHLC candlesticks with volume
  - calculateSMA() - Technical indicator calculation
  - saveChart() - Save to file
  - healthCheck() and connection status
- CLI commands:
  - status, health - Connection monitoring
  - line <symbol> - Generate line charts with --interval, --limit, --ma options
  - candle <symbol> - Generate candlestick charts with --volume option
  - Theme, width, height, output path customization
- Chart features:
  - Responsive SVG generation with configurable dimensions
  - Price formatting (adapts to value magnitude)
  - Date formatting (time for intraday, date for daily+)
  - Legend for moving averages
  - Grid lines with price labels
  - Current price highlight
- Typecheck passes
- Files changed:
  - skills/charts/package.json (new)
  - skills/charts/tsconfig.json (new)
  - skills/charts/.gitignore (new)
  - skills/charts/SKILL.md (new)
  - skills/charts/src/index.ts (new - main library with SVG generation)
  - skills/charts/src/cli.ts (new - CLI interface)
- **Learnings for future iterations:**
  - SVG chart generation is a great choice for pure JavaScript with no native dependencies
  - Using viewBox allows SVGs to scale to any size while maintaining aspect ratio
  - Coordinate mapping functions (getX, getY) make it easy to position elements
  - Linear gradients can add depth to charts (priceGradient for area fill)
  - Candlestick charts need separate handling for body (rect) and wick (line)
  - Volume bars should have lower opacity to not overpower price action
  - Theme objects make it easy to support multiple color schemes
  - Date formatting should adapt to timeframe (show time for intraday, dates for daily+)
---


## 2026-02-10 16:08 CET - US-015
- Created technical-analysis skill - Calculate technical indicators and signals for crypto trading
- Built on top of binance skill for price data (klines)
- Implemented comprehensive technical indicators:
  - RSI (Relative Strength Index) with configurable period and overbought/oversold thresholds
  - MACD with fast/slow/signal periods and crossover detection
  - Bollinger Bands with %B and bandwidth calculations
  - SMA (Simple Moving Average)
  - EMA (Exponential Moving Average)
  - WMA (Weighted Moving Average)
- Implemented signal generation system:
  - RSI overbought/oversold signals
  - MACD bullish/bearish crossover detection
  - Bollinger Bands %B position signals
  - Moving average crossover signals (golden/death cross)
  - Overall signal aggregation with confidence scoring
- Full CLI with commands:
  - rsi, macd, bb - Individual indicator commands
  - sma, ema, wma - Moving average commands
  - analyze - Complete technical analysis with all indicators
  - signals - Trading signals summary
  - status, health - Connection monitoring
- Typecheck passes
- Files changed:
  - skills/technical-analysis/package.json (new)
  - skills/technical-analysis/tsconfig.json (new)
  - skills/technical-analysis/.gitignore (new)
  - skills/technical-analysis/SKILL.md (new)
  - skills/technical-analysis/src/index.ts (new)
  - skills/technical-analysis/src/cli.ts (new)
- **Learnings for future iterations:**
  - RSI calculation tracks gains/losses separately, then averages over the period
  - MACD requires calculating EMAs of the price, then EMA of the MACD line for signal
  - Bollinger Bands %B = (Price - Lower) / (Upper - Lower), useful for position within bands
  - EMA uses a smoothing multiplier of 2/(period+1)
  - Signal generation compares current vs previous values to detect crossovers
  - Overall signal confidence is weighted by individual indicator confidences
---

## Codebase Patterns
- Skills are TypeScript-based with `SKILL.md` documentation in frontmatter format
- Use `src/` directory for TypeScript source files
- Use `sqlite3` package (not better-sqlite3) for SQLite - better compatibility
- **sqlite3 import**: Use `import * as sqlite3 from 'sqlite3'` (not default import)
- Encrypt sensitive data with `crypto-js` AES
- Store credentials in `~/.openclaw/skills/{skill-name}/`
- Use environment variables for OAuth client credentials
- Provider adapters implement base interface for OAuth flows
- PKCE is used for all OAuth flows for security
- Multi-profile support via (provider, profile) unique key
- Skills that depend on other skills should use `"@openclaw/auth-provider": "file:../auth-provider"` in package.json
- When extending auth-provider interfaces, export new types (UserProfile) from types.ts
- Async methods in AuthProvider require await when called from dependent skills
- **Race condition prevention**: If using async initialization (like SQLite), ensure `close()` waits for init to complete before cleaning up resources
- **SQLite run result**: To get `lastID` after INSERT, use a custom promisified wrapper that captures `this.lastID` from the callback:
  ```typescript
  function runWithResult(db: sqlite3.Database, sql: string, params: any[] = []): Promise<{ lastID: number; changes: number }> {
    return new Promise((resolve, reject) => {
      db.run(sql, params, function(this: sqlite3.RunResult, err: Error | null) {
        if (err) reject(err);
        else resolve({ lastID: this.lastID, changes: this.changes });
      });
    });
  }
  ```
- **Dynamic imports for ES modules**: When a dependency skill uses ES modules (type: module), use dynamic import() with async/await instead of static import
- **Database column naming**: SQLite returns snake_case column names. Create separate Record interfaces (snake_case) and convert to main interfaces (camelCase):
  ```typescript
  interface InvoiceRecord {
    id?: number;
    invoice_number: string;
    // ... snake_case columns
  }
  // Convert when fetching:
  return {
    id: record.id,
    invoiceNumber: record.invoice_number,
    // ...
  };
  ```

---

## 2026-02-10 16:25 CET - US-016
- Created invoices skill - Create, manage, and track professional invoices
- Complete TypeScript implementation with:
  - Invoice creation with line items and automatic total calculation
  - Professional PDF generation (HTML templates ready for PDF conversion)
  - Payment tracking with partial payment support
  - Client database management
  - Business configuration (tax rate, terms, invoice numbering)
  - Invoice status workflow: draft → sent → paid/overdue/cancelled
  - Automatic overdue detection for past-due invoices
  - Summary reports with revenue, outstanding, paid amounts
  - CSV export for accounting integration
- Database schema:
  - `config` - Business settings (name, tax rate, terms, invoice prefix)
  - `clients` - Client information
  - `invoices` - Invoice records with totals and status
  - `line_items` - Individual line items per invoice
  - `payments` - Payment records per invoice
- Key implementation details:
  - Invoice numbers auto-generated with configurable prefix (e.g., INV-0001)
  - Snake_case database columns mapped to camelCase TypeScript interfaces
  - Tax calculation: subtotal * (taxRate / 100)
  - Balance due = total - amount_paid
  - Status auto-updates to 'paid' when fully paid
  - Status auto-updates to 'overdue' when past due date and status is 'sent'
- Files changed:
  - skills/invoices/package.json (new)
  - skills/invoices/tsconfig.json (new)
  - skills/invoices/.gitignore (new)
  - skills/invoices/SKILL.md (updated to TypeScript)
  - skills/invoices/src/index.ts (new - main library)
  - skills/invoices/src/cli.ts (new - CLI interface)
  - Deleted old Python implementation
- **Learnings for future iterations:**
  - When using SQLite with TypeScript, create separate Record interfaces for snake_case column names
  - Map database records to camelCase interfaces when returning from methods
  - The invoice template uses CSS for professional appearance with status badges
  - CSV export format: headers with invoice details for accounting software import
  - Payment tracking allows partial payments - update balance and status accordingly
---


## 2026-02-10 16:30 CET - US-017
- Created receipts-ocr skill - Extract data from receipt photos using Google Vision API
- Built on top of google-oauth skill for authentication
- Implemented comprehensive OCR features:
  - Google Vision API integration with DOCUMENT_TEXT_DETECTION
  - Smart parsing for merchant names, amounts, dates, and line items
  - Confidence scoring for each extracted field (merchant, total, tax, date)
  - Auto-categorization based on merchant and content keywords
  - Payment method detection (Credit Card, Cash, Check, Digital Wallet)
- SQLite storage for:
  - Receipt records with all extracted fields and confidence scores
  - Line items table with quantity, unit price, total, confidence
  - Status tracking: pending → confirmed/corrected/rejected
- Full CLI with commands:
  - status, health - Connection monitoring
  - scan <image> - Process and save receipt with --copy and --notes options
  - text <image> - Extract text without saving to database
  - list, get - Query receipts with filtering
  - update, confirm, reject - Manual correction workflow
  - delete - Remove receipts and associated images
  - stats - Show spending breakdown by status and category
  - export [path] - CSV export for accounting
- Typecheck passes
- Files changed:
  - skills/receipts-ocr/package.json (new)
  - skills/receipts-ocr/tsconfig.json (new)
  - skills/receipts-ocr/.gitignore (new)
  - skills/receipts-ocr/SKILL.md (new)
  - skills/receipts-ocr/src/index.ts (new)
  - skills/receipts-ocr/src/cli.ts (new)
- **Learnings for future iterations:**
  - Google Vision API uses `images:annotate` endpoint with base64-encoded images
  - DOCUMENT_TEXT_DETECTION is better than TEXT_DETECTION for structured documents like receipts
  - Confidence scoring helps users prioritize which receipts need manual review
  - Status workflow (pending → confirmed/corrected/rejected) enables data quality tracking
  - Line item extraction uses regex patterns to identify prices at end of lines
  - Categories are inferred from merchant names and receipt content keywords
  - CSV export should escape quotes and wrap fields in quotes for proper parsing
---


## 2026-02-10 16:30 CET - US-018
- Created quickbooks skill - QuickBooks Online integration for accounting sync
- Built on top of quickbooks-auth skill for secure authentication
- Implemented comprehensive two-way sync features:
  - Sync customers from QuickBooks with conflict detection
  - Sync invoices with line items and status tracking
  - Sync transactions (payments, deposits, etc.)
  - SQLite cache for all synced data with local modification tracking
  - Conflict resolution system with local vs remote choice
  - Incremental sync support (since date parameter)
- Database schema includes:
  - customers table with full customer details
  - invoices table with line items sub-table
  - transactions table for financial transactions
  - sync_state table for tracking last sync times
  - conflicts table for unresolved sync conflicts
- CLI commands:
  - status, health - Connection monitoring
  - customers, customer-get, customer-sync - Customer management
  - invoices, invoice-get, invoice-sync - Invoice management  
  - transactions, transaction-sync - Transaction sync
  - sync - Full sync with entity type filtering
  - conflicts, conflict-resolve - Conflict management
  - sync-state - View sync timestamps
- Two-way sync strategy:
  - Pull changes from QuickBooks on sync
  - Track local modifications with local_modified flag
  - Detect conflicts when both local and remote changed
  - Allow resolving conflicts by keeping local or remote version
- Typecheck passes
- Files changed:
  - skills/quickbooks/package.json (new)
  - skills/quickbooks/tsconfig.json (new)
  - skills/quickbooks/.gitignore (new)
  - skills/quickbooks/SKILL.md (new)
  - skills/quickbooks/src/index.ts (new)
  - skills/quickbooks/src/cli.ts (new)
- **Learnings for future iterations:**
  - QuickBooks API uses QueryResponse wrapper for all query responses
  - Customer Balance field shows current open balance for the customer
  - Invoice status can be derived: Paid (Balance=0), Partial (Balance<Total), Overdue (DueDate passed)
  - Conflict resolution uses separate conflicts table with JSON local_data and remote_data
  - SQLite ON CONFLICT clause useful for upsert operations: `INSERT ... ON CONFLICT(qb_id) DO UPDATE ...`
  - Use `local_modified` flag to track entities that have local changes not yet pushed
  - Type assertions for JSON responses: `await response.json() as { QueryResponse?: { Customer?: any[] } }`
---


## 2026-02-10 16:35 CET - US-019
- Created reports skill - Generate financial reports (P&L, Balance Sheet, Cash Flow)
- Built on top of quickbooks and receipts-ocr skills for data aggregation
- Implemented comprehensive financial reporting features:
  - P&L Reports: Track revenue from QuickBooks invoices and expenses from receipts
  - Balance Sheets: Assets, liabilities, and equity calculation from customer balances and transactions
  - Cash Flow Reports: Operating, investing, and financing activities with net change tracking
  - Professional HTML export with styled reports ready for PDF conversion
  - Scheduled reports system with daily/weekly/monthly automation support
  - Report history tracking with filtering by type
- Database schema:
  - `scheduled_reports` - Configuration for automated report generation
  - `report_history` - Audit trail of all generated reports
- CLI commands:
  - status, health - Dependency health check (QuickBooks + Receipts OCR)
  - pl [period] [year] [month] - Generate P&L reports
  - balance [date] - Generate balance sheets
  - cashflow [period] [year] [month] - Generate cash flow reports
  - export <type> [path] - Export reports to styled HTML
  - history [type] [limit] - View report generation history
  - schedule create/list/delete - Manage scheduled reports
- Typecheck passes
- Files changed:
  - skills/reports/package.json (new)
  - skills/reports/tsconfig.json (new)
  - skills/reports/.gitignore (new)
  - skills/reports/SKILL.md (new)
  - skills/reports/src/index.ts (new - main library)
  - skills/reports/src/cli.ts (new - CLI interface)
- **Learnings for future iterations:**
  - Financial reports can aggregate data from multiple skills (quickbooks + receipts-ocr)
  - HTML generation with inline CSS is a good approach for PDF-ready reports
  - Use `getDateRange()` helper to calculate period boundaries (monthly, quarterly, yearly)
  - Revenue comes from QuickBooks invoices, expenses from confirmed receipts
  - Balance sheet balances when: Assets = Liabilities + Equity
  - Cash flow net change should equal: Operating + Investing + Financing
  - Type safety for union types like `ReportPeriod` requires careful casting in CLI args
  - Handle optional fields like `health.message` with fallback values
---


## 2026-02-10 16:45 CET - US-020
- Created tax-prep skill - Compile tax documents and summaries from invoices and receipts
- Built on top of invoices and receipts-ocr skills for data aggregation
- Implemented comprehensive tax preparation features:
  - Deductible expense categorization with 40+ IRS Schedule C category mappings
  - Auto-categorization based on merchant names and receipt keywords
  - Schedule C (Profit or Loss from Business) report generation
  - 1099 contractor tracking for payments >= $600
  - TurboTax-compatible CSV export
  - Complete accountant package with multiple export formats (JSON, HTML, CSV)
- IRS Category mappings include:
  - Advertising, Car and Truck, Contract Labor, Insurance
  - Legal/Professional Services, Office Expense, Rent/Lease
  - Repairs, Supplies, Taxes/Licenses, Travel, Meals (50% deductible)
  - Utilities, Interest, Wages, and more
- Special handling for meals (50% deductible) vs fully deductible categories
- SQLite storage for category mappings and categorized expenses
- Full CLI with commands: status, categorize, deductions, schedule-c, contractors, turbotax, package, summary, add-mapping
- Typecheck passes
- Files changed:
  - skills/tax-prep/package.json (new)
  - skills/tax-prep/tsconfig.json (new)
  - skills/tax-prep/.gitignore (new)
  - skills/tax-prep/SKILL.md (new)
  - skills/tax-prep/src/index.ts (new)
  - skills/tax-prep/src/cli.ts (new)
- **Learnings for future iterations:**
  - Skills can aggregate data from multiple other skills (invoices + receipts-ocr)
  - Category mapping system uses keyword matching with priority scoring
  - Meals are only 50% deductible while most other business expenses are 100%
  - Schedule C reports use standard IRS line numbers for each expense category
  - 1099 threshold is $600 - contractors receiving >= $600 require 1099 forms
  - Accountant package should include multiple formats: JSON (structured data), HTML (readable reports), CSV (spreadsheet import)
  - Tax year-based filtering uses YYYY-MM-DD date range queries
---

## 2026-02-10 16:55 CET - US-021
- Created content-writer skill - Generate content using AI for blogs, social media, and emails
- Implemented comprehensive content generation features:
  - Blog post generation with customizable word count and SEO keywords
  - Social media captions for Twitter/X, LinkedIn, Instagram, Facebook with platform constraints
  - Email templates for welcome, follow-up, promotional, newsletter, cold-outreach, thank-you
  - 8 tone options: professional, casual, friendly, formal, enthusiastic, empathetic, authoritative, witty
  - Platform-specific formatting (character limits, hashtag recommendations)
- Template system with 6 default templates:
  - Blog Post - How-To template with structured sections
  - Social Media templates for Twitter/X and LinkedIn
  - Email templates for Welcome, Follow-Up, and Promotional
  - Variable substitution with {{variableName}} syntax
- SQLite storage for:
  - Generated content history with full metadata
  - Content templates with variables
  - Tone preferences
- Full CLI with commands:
  - generate, g - Generate content with full options
  - history, h - View generation history
  - get <id> - Get specific content by ID
  - templates, t - List available templates
  - template-get <name> - View template details
  - stats - View usage statistics
  - tones - List available tones
  - platforms - List social platforms with constraints
  - health - System health check
- TypeScript implementation following all codebase patterns
- Typecheck passes
- No external API dependencies - uses local generation patterns
- Files changed:
  - skills/content-writer/package.json (new)
  - skills/content-writer/tsconfig.json (new)
  - skills/content-writer/.gitignore (new)
  - skills/content-writer/SKILL.md (new)
  - skills/content-writer/src/index.ts (new)
  - skills/content-writer/src/cli.ts (new)
- **Learnings for future iterations:**
  - Content generation skills don't need external API keys - they use the main model
  - Platform constraints should be enforced (e.g., Twitter 280 char limit)
  - Template system with variable substitution enables reusable content patterns
  - Tone modifiers are stored as descriptions that guide content generation
  - Multiple content types (blog, social, email) can share the same interface
  - SQLite storage enables content history and template management
---


## 2026-02-10 17:00 CET - US-022
- Created social-scheduler skill - Schedule posts to social platforms with queue management
- Implemented comprehensive scheduling features:
  - Queue management with SQLite storage for posts
  - Multi-platform support: Twitter/X, LinkedIn, Facebook, Instagram, YouTube, Generic
  - Optimal timing suggestions based on industry best practices per platform
  - Draft approval workflow with pending_approval → scheduled → published states
  - Natural language datetime parsing ("tomorrow", "in 2 hours", "tuesday at 9", etc.)
- Database schema:
  - posts table with status tracking, approval workflow, metadata
  - approval_log table for audit trail
  - publish_log table for tracking publish attempts
- Post status workflow: draft → pending_approval → scheduled → published/failed/cancelled
- CLI commands:
  - queue/add - Create new posts with --platform, --when, --approval options
  - list - List posts with filtering by status, platform, upcoming
  - get - Show detailed post info with approval and publish history
  - approve/reject - Approval workflow with notes
  - update - Modify post content or scheduled time
  - cancel/delete - Post management
  - due - List posts ready to publish
  - optimal-times - Show best posting times for platform
  - suggest-time - Get next optimal time for platform
  - stats - Queue statistics
  - health - System health check
- Typecheck passes
- Files changed:
  - skills/social-scheduler/package.json (new)
  - skills/social-scheduler/tsconfig.json (new)
  - skills/social-scheduler/.gitignore (new)
  - skills/social-scheduler/SKILL.md (new)
  - skills/social-scheduler/src/index.ts (new)
  - skills/social-scheduler/src/cli.ts (new)
- **Learnings for future iterations:**
  - Status workflow pattern: draft → pending_approval → scheduled → published/failed/cancelled
  - Natural language datetime parsing provides great UX for scheduling
  - Separate tables for approval_log and publish_log provide complete audit trails
  - Optimal posting times can be stored as constants based on industry research
  - The getNextOptimalTime() function finds the next available slot from current time
  - Post metadata field allows flexible additional data per platform
---

## 2026-02-10 17:01 CET - US-023
- Created engagement-replies skill - Draft replies to comments and messages with tone matching and sentiment awareness
- Implemented comprehensive features:
  - Generate multiple reply suggestions (configurable count) for any message
  - Sentiment analysis using keyword-based scoring with caching in SQLite
  - Automatic tone detection based on sentiment and message characteristics
  - 8 tone options: professional, casual, friendly, formal, enthusiastic, empathetic, authoritative, witty
  - 6 platform optimizations: twitter, linkedin, instagram, facebook, email, generic
  - 8 built-in quick response templates with variable substitution
  - Template categories: appreciation, engagement, support
  - Reply history tracking with full metadata
  - Statistics by platform, tone, and sentiment
- Sentiment detection features:
  - Positive/negative keyword matching
  - Emotion detection (joy, gratitude, excitement, anger, disappointment, confusion, curiosity)
  - Punctuation analysis (exclamations for enthusiasm, questions for curiosity)
  - Confidence scoring based on keyword density
  - SQLite caching for performance
- Three reply generation strategies:
  - Direct response: Straightforward acknowledgment and answer
  - Engaging reply: Follow-up questions to continue conversation
  - Appreciation reply: Gratitude-focused with community building
- Tone automatically adapts to sentiment:
  - Positive messages → friendly/enthusiastic tone
  - Negative messages → empathetic tone
  - Questions → professional tone
- Typecheck passes
- Files changed:
  - skills/engagement-replies/package.json (new)
  - skills/engagement-replies/tsconfig.json (new)
  - skills/engagement-replies/.gitignore (new)
  - skills/engagement-replies/SKILL.md (new)
  - skills/engagement-replies/src/index.ts (new)
  - skills/engagement-replies/src/cli.ts (new)
- **Learnings for future iterations:**
  - Sentiment analysis can be done locally with keyword lists - no API needed
  - Tone detection should consider both sentiment AND message characteristics (questions, exclamations)
  - Multiple reply variants provide users with different engagement strategies
  - Template variable substitution uses regex: `new RegExp('{{\\s*key\\s*}}', 'g')`
  - Sentiment caching using simple hash (message hash as key) improves performance
  - Platform constraints (max length) should be applied after reply generation
  - Emotion detection helps create more nuanced responses
---
## 2026-02-10 17:08 CET - US-024
- Created image-prompts skill - Generate AI image prompts for Midjourney, DALL-E, and Stable Diffusion
- Implemented comprehensive prompt generation features:
  - Support for 5 platforms: Midjourney, DALL-E, Stable Diffusion, Leonardo, and Generic
  - 15+ art styles with style-aware keyword modifiers (photorealistic, anime, cyberpunk, oil-painting, etc.)
  - 10 mood options with atmospheric keywords (mysterious, epic, whimsical, dark, etc.)
  - 10 lighting styles (cinematic, golden-hour, neon, volumetric, etc.)
  - 10 camera perspectives (birds-eye, macro, isometric, dutch-angle, etc.)
  - Auto-generated negative prompts per platform and style
  - Platform-specific parameter suggestions (stylize, chaos, aspect ratio, etc.)
  - Prompt variations generator for A/B testing
  - Template system with 5 default templates (character-portrait, landscape-scene, product-shot, etc.)
- SQLite storage for:
  - generated_prompts table with full metadata
  - prompt_templates table for reusable templates
  - style_presets table for custom configurations
- Full CLI with commands:
  - generate, g - Generate prompts with full options (--style, --mood, --lighting, --perspective, etc.)
  - template, t - Generate from template with variable substitution
  - templates - List available templates with filtering
  - history, h - View generation history
  - styles, moods, lighting, perspectives, platforms, aspect-ratios - List available options
  - parameters, params - Show platform-specific parameters
  - stats - Show generation statistics
  - health - System health check
- Typecheck passes
- Files changed:
  - skills/image-prompts/package.json (new)
  - skills/image-prompts/tsconfig.json (new)
  - skills/image-prompts/.gitignore (new)
  - skills/image-prompts/SKILL.md (new)
  - skills/image-prompts/src/index.ts (new - main library)
  - skills/image-prompts/src/cli.ts (new - CLI interface)
- **Learnings for future iterations:**
  - Each platform has different parameter systems (Midjourney uses --flags, DALL-E uses API params)
  - Negative prompts are platform-specific (Midjourney uses --no, Stable Diffusion uses separate field)
  - Style keywords should be comprehensive to ensure good generation results
  - Template variable substitution uses regex: `new RegExp('{{\\s*key\\s*}}', 'g')`
  - Aspect ratio handling differs: Midjourney uses --ar, DALL-E uses size, SD uses width/height
  - Variations can be generated by cycling through different style/mood/lighting combinations
---

## Codebase Patterns
- Skills are TypeScript-based with `SKILL.md` documentation in frontmatter format
- Use `src/` directory for TypeScript source files
- Use `sqlite3` package (not better-sqlite3) for SQLite - better compatibility
- **sqlite3 import**: Use `import * as sqlite3 from 'sqlite3'` (not default import)
- Encrypt sensitive data with `crypto-js` AES
- Store credentials in `~/.openclaw/skills/{skill-name}/`
- Use environment variables for OAuth client credentials
- Provider adapters implement base interface for OAuth flows
- PKCE is used for all OAuth flows for security
- Multi-profile support via (provider, profile) unique key
- Skills that depend on other skills should use `"@openclaw/auth-provider": "file:../auth-provider"` in package.json
- When extending auth-provider interfaces, export new types (UserProfile) from types.ts
- Async methods in AuthProvider require await when called from dependent skills
- **Race condition prevention**: If using async initialization (like SQLite), ensure `close()` waits for init to complete before cleaning up resources
- **SQLite run result**: To get `lastID` after INSERT, use a custom promisified wrapper that captures `this.lastID` from the callback:
  ```typescript
  function runWithResult(db: sqlite3.Database, sql: string, params: any[] = []): Promise<{ lastID: number; changes: number }> {
    return new Promise((resolve, reject) => {
      db.run(sql, params, function(this: sqlite3.RunResult, err: Error | null) {
        if (err) reject(err);
        else resolve({ lastID: this.lastID, changes: this.changes });
      });
    });
  }
  ```
- **Dynamic imports for ES modules**: When a dependency skill uses ES modules (type: module), use dynamic import() with async/await instead of static import
- **Database column naming**: SQLite returns snake_case column names. Create separate Record interfaces (snake_case) and convert to main interfaces (camelCase):
  ```typescript
  interface InvoiceRecord {
    id?: number;
    invoice_number: string;
    // ... snake_case columns
  }
  // Convert when fetching:
  return {
    id: record.id,
    invoiceNumber: record.invoice_number,
    // ...
  };
  ```
- **Seeding data**: When seeding default data, use `runWithResult()` in a loop with await instead of prepared statements for proper async handling

---

## 2026-02-10 17:15 CET - US-025
- Created hashtag-research skill - Find relevant and trending hashtags for social media
- Implemented comprehensive hashtag research features:
  - Keyword-based hashtag suggestions with relevance scoring
  - Trending analysis by platform and category
  - Niche discovery for finding low-competition hashtags
  - Content-based hashtag suggestions (analyze text and suggest tags)
  - 55 curated default hashtags across 11 categories
  - 16 content categories: general, lifestyle, business, tech, fashion, food, travel, fitness, art, photography, music, sports, health, education, marketing, entrepreneur
  - Competition level classification (low/medium/high)
  - Multi-platform support: Instagram, Twitter/X, TikTok, LinkedIn, Facebook
- SQLite storage for:
  - hashtags table with trending scores and metadata
  - search_history table for tracking research queries
  - trending_cache table for future trending data
- Full CLI with commands:
  - research/r - Research hashtags by keywords
  - suggest/s - Suggest hashtags for content
  - trending/t - Show trending hashtags
  - niche/n - Discover niche hashtags
  - add/a - Add custom hashtags
  - stats - Database statistics
  - history/h - Search history
  - categories - List categories
  - platforms - List platforms
  - health - System health
- No external API required - uses local database and scoring algorithms
- Typecheck passes
- Files changed:
  - skills/hashtag-research/package.json (new)
  - skills/hashtag-research/tsconfig.json (new)
  - skills/hashtag-research/.gitignore (new)
  - skills/hashtag-research/SKILL.md (new)
  - skills/hashtag-research/src/index.ts (new - main library)
  - skills/hashtag-research/src/cli.ts (new - CLI interface)
- **Learnings for future iterations:**
  - When seeding default data, use individual INSERTs with `runWithResult()` instead of prepared statements for proper async handling
  - Hashtag research skills don't need external APIs - local database with scoring works well
  - Relevance scoring algorithm combines keyword matching, category matching, and competition preference
  - Competition level (low/medium/high) helps users choose hashtags with better visibility chances
  - Copy-paste ready output format is useful for social media workflows
---

## 2026-02-10 17:25 CET - US-026
- Created payment-reminders skill - Automated payment reminder emails for invoice chasing
- Built on top of invoices and email skills for data and email delivery
- Implemented comprehensive reminder system:
  - Escalating reminder schedules with configurable days before/after due date
  - 3 default schedules: Standard (7,3 days before / 7,14,30 after), Gentle, Aggressive
  - 7 default email templates across 4 stages: pre_due, on_due, post_due, final
  - 3 tone options: friendly, firm, urgent
  - Template variable system: {{clientName}}, {{invoiceNumber}}, {{amount}}, {{dueDate}}, etc.
  - Client-specific settings (enable/disable, custom schedules)
  - Full reminder history tracking with success/failure status
  - Dry-run mode for testing
  - Preview functionality to see reminders before sending
- SQLite storage for:
  - reminder_schedules - Configurable schedules with JSON arrays for days
  - reminder_templates - Email templates with stage/tone classification
  - client_settings - Per-client reminder preferences
  - reminder_history - Audit trail of all sent reminders
- Full CLI with commands:
  - status/health - Check connection to dependencies
  - schedules - List reminder schedules
  - templates - List templates by stage
  - client-settings/enable/disable - Manage client preferences
  - pending - List reminders ready to send
  - send-all --dry-run - Preview all pending reminders
  - preview/send - Work with specific invoices
  - history/stats - View activity and statistics
- Typecheck passes
- Files changed:
  - skills/payment-reminders/package.json (new)
  - skills/payment-reminders/tsconfig.json (new)
  - skills/payment-reminders/.gitignore (new)
  - skills/payment-reminders/SKILL.md (new)
  - skills/payment-reminders/src/index.ts (new - main library)
  - skills/payment-reminders/src/cli.ts (new - CLI interface)
- **Learnings for future iterations:**
  - When a dependency skill returns `Type | null` and you're using `find()` which returns `Type | undefined`, explicitly type the variable as `Type | null`
  - Template variable substitution uses regex: `replace(/\{\{(\w+)\}\}/g, ...)`
  - JSON arrays in SQLite are stored as strings and parsed with `JSON.parse()` when retrieved
  - Use dynamic imports for ES module skills: `const { EmailSkill } = await import('@openclaw/email')`
  - The `daysBeforeDue` and `daysAfterDue` arrays define when reminders trigger
  - Stage progression: pre_due → on_due → post_due → final based on days relative to due date
---

## 2026-02-10 17:30 CET - US-027
- Created client-tracker skill - Track client payment behavior and history
- Built on top of invoices skill for client and invoice data
- Implemented comprehensive client tracking features:
  - Extended client profiles with payment statistics (total invoices, revenue, outstanding)
  - Payment history sync from invoices with days-late calculation
  - Credit risk scoring algorithm with 4 weighted factors:
    - On-time payment rate (40% weight)
    - Average payment days (30% weight)
    - Outstanding vs overdue ratio (20% weight)
    - Payment history length (10% weight)
  - Risk levels: low (80-100), medium (60-79), high (0-59)
  - Outstanding balances report with sorting by amount
  - Communication log for tracking client interactions
  - CSV export for client data
- Database schema:
  - payment_history table for tracking paid invoices with days_late
  - communication_log table for client interaction tracking
- Full CLI with commands:
  - list, profile - Client viewing
  - payments, risk - Payment history and risk assessment
  - log, communications - Communication tracking
  - balances, stats - Reporting
  - export, sync - Data management
- Typecheck passes
- Files changed:
  - skills/client-tracker/package.json (new)
  - skills/client-tracker/tsconfig.json (new)
  - skills/client-tracker/.gitignore (new)
  - skills/client-tracker/SKILL.md (new)
  - skills/client-tracker/src/index.ts (new - main library)
  - skills/client-tracker/src/cli.ts (new - CLI interface)
- **Learnings for future iterations:**
  - Risk scoring algorithms should use weighted factors for balanced assessment
  - Days late calculation: Math.max(0, Math.ceil((paidDate - dueDate) / (1000 * 60 * 60 * 24)))
  - When syncing from dependent skills, use INSERT OR REPLACE for idempotency
  - Payment history can be derived from invoices with status='paid' and payments array
  - Risk factors should include both positive and negative indicators
  - Communication logs enable CRM-style functionality without external dependencies
---


## 2026-02-10 17:35 CET - US-028
- Created expense-categorizer skill - Auto-categorize expenses from receipts with learning from corrections
- Built on top of receipts-ocr skill for receipt data
- Implemented comprehensive categorization features:
  - Smart categorization using rule-based and ML-inspired algorithms
  - 12 default categories (Groceries, Dining, Gas, Pharmacy, Office, Electronics, Transportation, Entertainment, Retail, Utilities, Travel, Healthcare)
  - Custom category support with user-defined keywords
  - Learning system that improves accuracy from user corrections
  - Bulk categorization for processing multiple receipts at once
  - Confidence scoring for each categorization
  - Merchant-to-category mapping based on history
- Database schema includes:
  - categories table with keywords (JSON) and parent category support
  - merchant_mappings table with confidence scores and receipt counts
  - learning_records table for tracking corrections and improving accuracy
- Categorization algorithm prioritizes:
  1. Merchant mappings (highest priority, learned from corrections)
  2. Keyword matching against merchant names
  3. Keyword matching against receipt content
  4. Line item analysis
- CLI commands:
  - status/health - System status
  - categories, add-category, delete-category - Category management
  - suggest, categorize, bulk - Categorization operations
  - correct - Apply corrections (teaches the system)
  - merchants, map-merchant, delete-mapping - Merchant management
  - stats, accuracy, history - Analytics and reporting
- Typecheck passes
- Files changed:
  - skills/expense-categorizer/package.json (new)
  - skills/expense-categorizer/tsconfig.json (new)
  - skills/expense-categorizer/.gitignore (new)
  - skills/expense-categorizer/SKILL.md (new)
  - skills/expense-categorizer/src/index.ts (new)
  - skills/expense-categorizer/src/cli.ts (new)
  - prd.json (updated US-028 passes: true)
- **Learnings for future iterations:**
  - When querying SQLite with different field names (snake_case vs camelCase), create separate local interface types
  - Learning system stores corrections and uses them to improve merchant mappings
  - Merchant mappings get confidence boost (0.95) when verified by user correction
  - Categorization confidence levels: >=5 keywords (90%), >=3 keywords (75%), >=1 keyword (60%), <1 keyword (40%)
  - Use INSERT OR IGNORE for seeding default data to avoid duplicates
  - JSON.stringify/parse for storing arrays (keywords) in SQLite
---

## Codebase Patterns
- Skills are TypeScript-based with `SKILL.md` documentation in frontmatter format
- Use `src/` directory for TypeScript source files
- Use `sqlite3` package (not better-sqlite3) for SQLite - better compatibility
- **sqlite3 import**: Use `import * as sqlite3 from 'sqlite3'` (not default import)
- Encrypt sensitive data with `crypto-js` AES
- Store credentials in `~/.openclaw/skills/{skill-name}/`
- Use environment variables for OAuth client credentials
- Provider adapters implement base interface for OAuth flows
- PKCE is used for all OAuth flows for security
- Multi-profile support via (provider, profile) unique key
- Skills that depend on other skills should use `"@openclaw/auth-provider": "file:../auth-provider"` in package.json
- When extending auth-provider interfaces, export new types (UserProfile) from types.ts
- Async methods in AuthProvider require await when called from dependent skills
- **Race condition prevention**: If using async initialization (like SQLite), ensure `close()` waits for init to complete before cleaning up resources
- **SQLite run result**: To get `lastID` after INSERT, use a custom promisified wrapper that captures `this.lastID` from the callback:
  ```typescript
  function runWithResult(db: sqlite3.Database, sql: string, params: any[] = []): Promise<{ lastID: number; changes: number }> {
    return new Promise((resolve, reject) => {
      db.run(sql, params, function(this: sqlite3.RunResult, err: Error | null) {
        if (err) reject(err);
        else resolve({ lastID: this.lastID, changes: this.changes });
      });
    });
  }
  ```
- **Dynamic imports for ES modules**: When a dependency skill uses ES modules (type: module), use dynamic import() with async/await instead of static import
- **Database column naming**: SQLite returns snake_case column names. Create separate Record interfaces (snake_case) and convert to main interfaces (camelCase):
  ```typescript
  interface InvoiceRecord {
    id?: number;
    invoice_number: string;
    // ... snake_case columns
  }
  // Convert when fetching:
  return {
    id: record.id,
    invoiceNumber: record.invoice_number,
    // ...
  };
  ```
- **Seeding data**: When seeding default data, use `runWithResult()` in a loop with await instead of prepared statements for proper async handling

---

## 2026-02-10 17:40 CET - US-029
- Created tax-export skill - Export expenses for tax filing with multiple formats
- Built on top of expense-categorizer skill for categorized receipt data
- Implemented comprehensive export features:
  - CSV export with IRS category mapping and deductible calculations
  - PDF report generation (HTML format ready for PDF conversion)
  - Receipt bundle export (JSON metadata with image paths)
  - Complete tax package export (CSV + PDF + bundle in one command)
- Implemented deductible filtering and category filtering
- IRS Schedule C category mappings with 21 standard categories
- Deductible rates (100% for most, 50% for meals)
- Custom category mapping support
- Export history tracking in SQLite
- Full CLI with commands: status, health, csv, pdf, bundle, export, irs-categories, mappings, set-mapping, history, stats
- Typecheck passes
- Files changed:
  - skills/tax-export/package.json (new)
  - skills/tax-export/tsconfig.json (new)
  - skills/tax-export/.gitignore (new)
  - skills/tax-export/SKILL.md (new)
  - skills/tax-export/src/index.ts (new - main library)
  - skills/tax-export/src/cli.ts (new - CLI interface)
- **Learnings for future iterations:**
  - When filtering arrays with async operations, filter non-async criteria first, then handle async criteria in a separate loop
  - Use type assertion `(mapping as CategoryIRSMapping).deductibleRate` when TypeScript strict null checks don't recognize the null check
  - CSV escaping should handle commas, quotes, and newlines: `"${field.replace(/"/g, '""')}"`
  - PDF reports can be generated as HTML first, which is ready for PDF conversion tools
  - Receipt bundles store metadata as JSON with image paths for audit trails
---

## 2026-02-10 17:47 CET - US-030
- Created web-search skill - Search the web for information with structured results
- Implemented comprehensive search features:
  - Query search with configurable number of results
  - Structured results with title, URL, snippet, source, and rank
  - Source ranking by relevance
  - Result caching in SQLite with 7-day TTL
  - Safe search filtering option
- Dual-mode operation:
  - Serper API mode: When SERPER_API_KEY is set, uses Serper.dev API for automated results
  - Fallback mode: Returns links to Google, Bing, DuckDuckGo search pages when no API key
- SQLite storage for:
  - search_cache table with query, results, total_results, created_at
  - Automatic cache expiration based on creation date
  - Cache stats tracking
- Full CLI with commands:
  - search/s <query> - Search with --num, --safe, --no-safe options
  - cache - View cache statistics
  - clear-cache --days N - Clear old entries
  - health/h - Check system health and API availability
- Typecheck passes
- No external API dependencies by default - works without any API key
- Files changed:
  - skills/web-search/package.json (new)
  - skills/web-search/tsconfig.json (new)
  - skills/web-search/.gitignore (new)
  - skills/web-search/SKILL.md (new)
  - skills/web-search/src/index.ts (new - main library)
  - skills/web-search/src/cli.ts (new - CLI interface)
  - prd.json (updated US-030 passes: true)
- **Learnings for future iterations:**
  - When implementing optional external API integration, provide a fallback mode that still works
  - HTTPS requests in Node.js use the `https` module with options for hostname, path, method, headers
  - For POST requests, calculate Content-Length with Buffer.byteLength()
  - Cache TTL can be implemented at query time with `created_at > datetime("now", "-7 days")`
  - When no API key is available, returning search engine links is a useful fallback
---


## 2026-02-10 17:50 CET - US-031
- Created news-aggregator skill - RSS/Atom feed aggregator with keyword filtering and source management
- Implemented comprehensive features:
  - RSS 2.0 and Atom feed parsing using fast-xml-parser
  - Source management with name, URL, category, and active/inactive status
  - Keyword filtering system with include/exclude filters and priority scoring
  - Deduplication by GUID with find and remove functions
  - Full feed item lifecycle: fetch, read/unread, save/unsave
  - Fetch error tracking per source with automatic retry counting
  - Comprehensive CLI with all commands for management
- Database schema:
  - feed_sources table with error tracking and last fetch timestamp
  - feed_items table with read/saved status and full text indexing
  - keyword_filters table with include/exclude and priority
- CLI commands:
  - sources, add, remove, enable, disable - Source management
  - fetch, list, read, mark-read, save, unsave - Feed operations
  - filters, filter-add, filter-remove, filtered - Keyword filtering
  - duplicates, dedupe - Deduplication
  - stats, health - Monitoring
- Typecheck passes
- Files changed:
  - skills/news-aggregator/package.json (new)
  - skills/news-aggregator/tsconfig.json (new)
  - skills/news-aggregator/.gitignore (new)
  - skills/news-aggregator/SKILL.md (new)
  - skills/news-aggregator/src/index.ts (new - main library)
  - skills/news-aggregator/src/cli.ts (new - CLI interface)
- **Learnings for future iterations:**
  - fast-xml-parser is a good choice for RSS/Atom parsing - no native dependencies
  - RSS and Atom have different structures: RSS uses channel.item[], Atom uses feed.entry[]
  - Atom links are complex - may be an array with @rel attributes or single object
  - GUID deduplication is essential for RSS feeds (same story can appear in multiple sources)
  - Use both http and https modules for fetching - not all feeds use HTTPS
  - Feed error tracking helps identify problematic sources
---

## 2026-02-10 17:54 CET - US-032
- Created summarizer skill - Text summarization with key point extraction
- Implemented extractive summarization algorithm using local text processing (no external API)
- Features implemented:
  - Article and document summarization with adjustable length (short/medium/long)
  - Key points extraction with configurable count
  - Multiple output formats: paragraph, bullet points, numbered list
  - Document type optimization: article, document, email, meeting, research
  - Focus keywords support to emphasize specific topics
  - File summarization support
- Scoring algorithm considers:
  - Document-type specific keywords (higher weight)
  - Focus keywords (highest weight)
  - Statistical indicators (percentages, currency amounts)
  - Structural cues (transition words, position)
  - Optimal sentence length
- SQLite storage for summary history with compression stats
- Full CLI with commands: summarize, file, history, get, stats, clear, delete, health
- Typecheck passes
- Files changed:
  - skills/summarizer/package.json (new)
  - skills/summarizer/tsconfig.json (new)
  - skills/summarizer/.gitignore (new)
  - skills/summarizer/SKILL.md (new)
  - skills/summarizer/src/index.ts (new)
  - skills/summarizer/src/cli.ts (new)
  - prd.json (updated US-032 passes: true)
- **Learnings for future iterations:**
  - Extractive summarization works well without external APIs - score sentences based on keywords and structure
  - Document-type specific keyword boosts improve relevance for different content types
  - Focus keywords allow users to customize summaries for their needs
  - Compression ratio tracking helps users understand summary efficiency
  - SQLite storage enables summary history and statistics tracking
---


## 2026-02-10 17:58 CET - US-033
- Created inbox-triage skill - AI-powered email prioritization and sorting system
- Implemented comprehensive email classification features:
  - 9 email categories: urgent, important, newsletter, promotional, social, updates, forums, spam, unknown
  - 5 priority levels: critical, high, medium, low, none with 0-100 scoring
  - AI classification algorithm analyzing sender patterns, subject keywords, content indicators
  - Confidence scoring based on pattern matching strength
- Implemented bulk actions with undo support:
  - Bulk archive, mark as read, and trash operations
  - 24-hour undo window for all bulk actions
  - Previous state tracking for restoration
- Implemented sender rules system:
  - Custom rules for specific email addresses
  - Auto-categorization and priority assignment
  - Rule management (add, list, delete)
- SQLite storage for:
  - classifications table with full metadata
  - sender_rules table for custom rules
  - undo_actions table with 24hr expiration
  - action_history table for audit trail
- Full CLI with commands:
  - status/health - System health check
  - classify/triage/inbox - Email classification
  - category/priority - Query by classification
  - unreviewed/review - Review workflow
  - archive/mark-read/trash/undo - Bulk actions
  - add-rule/rules/delete-rule - Sender rule management
  - stats - Classification statistics
- TypeScript implementation following all codebase patterns
- Typecheck passes
- Files changed:
  - skills/inbox-triage/package.json (new)
  - skills/inbox-triage/tsconfig.json (new)
  - skills/inbox-triage/.gitignore (new)
  - skills/inbox-triage/SKILL.md (new)
  - skills/inbox-triage/src/index.ts (new - main library)
  - skills/inbox-triage/src/cli.ts (new - CLI interface)
  - prd.json (updated US-033 passes: true)
- **Learnings for future iterations:**
  - Classification algorithm uses multi-factor scoring (sender patterns, keywords, labels, thread status)
  - Confidence calculation: base 0.5 + (reasons * 0.15), capped at 0.95
  - Undo system stores previous states as JSON and expires after 24 hours
  - Sender rules override AI classification for known senders
  - SQLite ON CONFLICT clause useful for upsert when re-classifying
  - Classification Record interfaces needed for snake_case column mapping
---


## 2026-02-10 18:01 CET - US-034
- Created draft-responses skill - Generate email reply suggestions with multiple tone options and context-aware drafting
- Built on top of email skill for reading messages and sending replies
- Implemented comprehensive features:
  - 8 tone options: professional, casual, friendly, formal, enthusiastic, empathetic, authoritative, witty
  - Context-aware drafting that analyzes email content (questions, urgency, thanks, meeting requests)
  - Thread context support - considers previous messages for continuity
  - One-click send functionality to send drafts directly via email skill
  - Template system with 8 default templates (thank-you, acknowledgment, follow-up, meeting-accept, meeting-decline, information-request, deadline-extension, apology)
  - Template variable substitution with {{variableName}} syntax
  - SQLite storage for draft history with send tracking
- Content analysis for better responses:
  - Detects thank you messages, questions, meeting requests, urgency
  - Adapts response style based on email type
  - Sentiment-aware tone suggestions
- Full CLI with commands:
  - generate - Create draft suggestions with --tones, --count, --no-context options
  - drafts - List all drafts or drafts for specific email
  - send - Send a draft by ID
  - delete - Remove a draft
  - template - Apply templates with variable substitution
  - templates - List available templates
  - tones - Show available tones
  - stats - View usage statistics
  - health - Check email skill connection
- TypeScript implementation following all codebase patterns
- Typecheck passes
- Files changed:
  - skills/draft-responses/package.json (new)
  - skills/draft-responses/tsconfig.json (new)
  - skills/draft-responses/.gitignore (new)
  - skills/draft-responses/SKILL.md (new)
  - skills/draft-responses/src/index.ts (new)
  - skills/draft-responses/src/cli.ts (new)
- **Learnings for future iterations:**
  - Skills can use dynamic imports for ES module dependencies: `const { EmailSkill } = await import('@openclaw/email')`
  - When depending on email skill, use `emailSkill.reply()` for one-click send functionality
  - Context-aware drafting analyzes email content patterns (isUrgent, isThankYou, isRequest, isMeeting, isQuestion)
  - Template variable substitution uses regex: `new RegExp('{{\\s*key\\s*}}', 'g')`
  - Tone modifiers provide descriptions that guide response generation style
  - Content analysis enables more relevant and appropriate draft suggestions
  - SQLite storage for drafts enables history tracking and statistics
---


## 2026-02-10 18:08 CET - US-035
- Created gift-suggestions skill - Suggest personalized gift ideas based on recipient profiles
- Implemented comprehensive features:
  - Recipient profile management with SQLite storage (name, relationship, age, gender, interests, notes)
  - Smart gift suggestion algorithm with interest matching, budget filtering, occasion matching
  - 64 curated gift ideas across 8 categories (Tech, Experiences, Home, Fashion, Books, Wellness, Food, Entertainment)
  - Trending gift tracking with popularity scores
  - Gift history tracking with recipient reactions (loved, liked, neutral, disliked)
  - Occasion-appropriate suggestions (birthday, christmas, anniversary, etc.)
  - Age and gender considerations for appropriate suggestions
  - Exclude previously gifted items option
- Suggestion algorithm scoring factors:
  - Interest matches (25 points per match)
  - Budget fit (15 points if fully within budget, 5 if partially)
  - Occasion match (20 points)
  - Age appropriateness (10 points)
  - Gender match (5 points)
  - Trending bonus (10 points)
- Full CLI with commands:
  - Recipient management: add-recipient, list-recipients, get-recipient, update-recipient, delete-recipient
  - Suggestions: suggest, suggest-interests
  - Discovery: trending, categories, budget
  - History: add-history, history
  - Reporting: stats, health
- Typecheck passes
- Files changed:
  - skills/gift-suggestions/package.json (new)
  - skills/gift-suggestions/tsconfig.json (new)
  - skills/gift-suggestions/.gitignore (new)
  - skills/gift-suggestions/SKILL.md (new)
  - skills/gift-suggestions/src/index.ts (new - main library)
  - skills/gift-suggestions/src/cli.ts (new - CLI interface)
- **Learnings for future iterations:**
  - Gift suggestion skills can use local curated databases rather than external APIs
  - Multi-factor scoring algorithms work well for recommendation systems
  - Interest matching is the most important factor (highest weight)
  - Gift history tracking helps avoid duplicate gifts and improve future suggestions
  - Reaction tracking (loved/liked/neutral/disliked) can train better recommendations
  - When using await in template literals or callbacks, extract the value first to avoid async issues
---

## 2026-02-10 18:13 CET - US-036
- Created occasion-reminders skill - Track birthdays and anniversaries with gift planning timeline
- Built on top of reminders skill for advance notice notifications
- Implemented comprehensive features:
  - Contact management with import support (CSV, JSON)
  - Occasion tracking (birthdays, anniversaries, holidays, custom)
  - Advance notice configuration (weeks + days)
  - Gift planning timeline with suggested actions
  - Budget tracking and gift ideas storage
  - Age calculation for birthdays
  - Years together calculation for anniversaries
- Database schema:
  - contacts table with name, email, phone, relationship, notes
  - occasions table with type, date, advance notice settings, gift info
  - Foreign key relationship with cascade delete
- Full CLI with commands:
  - Contact management: add-contact, list-contacts, get-contact, update-contact, delete-contact, import
  - Occasion management: add-occasion, list-occasions, get-occasion, update-occasion, delete-occasion
  - Queries: upcoming, birthdays, anniversaries, timeline, search, stats
- Typecheck passes
- Files changed:
  - skills/occasion-reminders/package.json (new)
  - skills/occasion-reminders/tsconfig.json (new)
  - skills/occasion-reminders/.gitignore (new)
  - skills/occasion-reminders/SKILL.md (new)
  - skills/occasion-reminders/src/index.ts (new - main library)
  - skills/occasion-reminders/src/cli.ts (new - CLI interface)
  - prd.json (updated US-036 passes: true)
- **Learnings for future iterations:**
  - When depending on other skills (like reminders), create them in constructor and close them in close()
  - Use calculateNextOccurrence() to handle year-rolling for annual events
  - Gift planning timeline should only show items where isAdvanceNotice is true
  - Snake_case column names in SQLite map to camelCase in TypeScript interfaces
  - Import functionality supports JSON arrays and simple CSV formats
  - Timeline calculations adapt based on days until occasion (14 days to shop, 7 days to order, 1 day to wrap)
---

## 2026-02-10 18:18 CET - US-037
- Created recipe-suggester skill - Suggest recipes based on dietary preferences, ingredients, and cuisine
- Implemented comprehensive features:
  - 30 curated recipes across 10 cuisines (Italian, Mexican, Asian, Thai, Greek, Mediterranean, American, Indian, Japanese, French)
  - 9 dietary filters: vegetarian, vegan, gluten-free, keto, paleo, dairy-free, nut-free, low-carb, low-sodium
  - 3 difficulty levels: easy, medium, hard
  - 6 meal types: breakfast, lunch, dinner, snack, dessert, appetizer
  - Ingredient-based recipe search with match percentage
  - Multi-factor scoring algorithm for recipe suggestions
  - Recipe favorites and cooking history tracking
  - Nutritional information for recipes
- Scoring algorithm prioritizes:
  - Dietary matching (30 points for all requirements)
  - Cuisine matching (25 points)
  - Meal type matching (20 points)
  - Difficulty matching (15 points)
  - Time constraints (10 points)
  - Tag matching (8 points per match)
- Ingredient search finds recipes by available ingredients with configurable match threshold
- SQLite storage for favorites and cooking history
- Full CLI with commands:
  - suggest/search - Find recipes with filters (--dietary, --cuisine, --difficulty, --meal, --time, --servings)
  - by-ingredients - Find recipes matching available ingredients
  - get/view - View full recipe details with ingredients and instructions
  - random - Get random recipe suggestion with optional filters
  - cuisine, dietary, difficulty, quick - List recipes by category
  - diets, cuisines, meals - List available filters
  - stats - Database statistics
  - cooked - Mark recipe as cooked with rating and notes
  - favorite/fav, favorites - Manage favorite recipes
- Typecheck passes
- Files changed:
  - skills/recipe-suggester/package.json (new)
  - skills/recipe-suggester/tsconfig.json (new)
  - skills/recipe-suggester/.gitignore (new)
  - skills/recipe-suggester/SKILL.md (new)
  - skills/recipe-suggester/src/index.ts (new - main library)
  - skills/recipe-suggester/src/cli.ts (new - CLI interface)
  - prd.json (updated US-037 passes: true)
- **Learnings for future iterations:**
  - Curated recipe database approach works well for local-only skills (no API needed)
  - Multi-factor scoring algorithm provides better recommendations than simple filtering
  - Ingredient matching with percentage threshold helps users find recipes they can make
  - Recipe data structure should include: id, name, description, cuisine, dietary[], difficulty, mealType, prepTime, cookTime, servings, ingredients[], instructions[], tags[], nutritional info
  - SQLite tracking for user interactions (favorites, history) adds value without external dependencies
  - CLI argument parsing for comma-separated lists: use `value.split(',').map(v => v.trim())`
---


## 2026-02-10 18:26 CET - US-038
- Created shopping-list-generator skill - Generate organized shopping lists from meal plans with pantry checking
- Built on top of recipe-suggester skill for recipe data
- Implemented comprehensive features:
  - Generate shopping lists from recipe IDs with automatic ingredient extraction
  - Smart categorization by store section (produce, meat, seafood, dairy, bakery, frozen, pantry, beverages, household, other)
  - Pantry check to skip items already in inventory
  - Duplicate merging when multiple recipes share ingredients
  - Servings scaling to adjust quantities
  - Full pantry management with expiration tracking
- Database schema:
  - shopping_lists table for list metadata
  - shopping_items table with section and recipe references
  - pantry_items table with expiration dates
- Full CLI with commands:
  - generate - Create lists from recipe IDs with --pantry-check, --merge-duplicates, --scale options
  - create, list, get, delete - List management
  - add, toggle, remove, clear-checked - Item management
  - sections - View items grouped by store section
  - export - Text format export
  - pantry-add, pantry-remove, pantry-list, pantry-search, pantry-check - Pantry management
  - stats, health - Monitoring
- Typecheck passes
- Files changed:
  - skills/shopping-list-generator/package.json (new)
  - skills/shopping-list-generator/tsconfig.json (new)
  - skills/shopping-list-generator/.gitignore (new)
  - skills/shopping-list-generator/SKILL.md (new)
  - skills/shopping-list-generator/src/index.ts (new - main library)
  - skills/shopping-list-generator/src/cli.ts (new - CLI interface)
  - prd.json (updated US-038 passes: true)
- **Learnings for future iterations:**
  - Recipe-suggester method is `getRecipeById()` not `getRecipe()`
  - Store section categorization uses keyword matching against ingredient names
  - Pantry check queries with LIKE for partial matching (e.g., "olive oil" matches "extra virgin olive oil")
  - Section keywords should cover common variations (e.g., "scallion" and "green onion")
  - When scaling amounts, handle fractions (1/2, 1/4) and mixed numbers
  - Combining amounts requires checking for same units before adding
---



## 2026-02-10 18:30 CET - US-039
- Created maintenance-scheduler skill - Schedule recurring home maintenance tasks with seasonal templates
- Built on top of reminders skill for notification scheduling
- Implemented comprehensive features:
  - Seasonal templates for 3 home types: House (16 tasks), Apartment (11 tasks), Condo (10 tasks)
  - Task frequency support: Monthly (30 days), Quarterly (90 days), Bi-annual (180 days), Annual (365 days), Custom (any days)
  - Custom task creation with name, description, frequency, advance notice, and category
  - Completion tracking with history and notes
  - Notification timing via reminders skill integration
  - Categories: indoor, outdoor, hvac, plumbing, electrical, appliance, safety, cleaning, other
- Database schema:
  - tasks table with schedule configuration and next due date
  - completion_history table with completion notes
- Full CLI with commands:
  - apply-template, preview-template, templates - Template management
  - create, list, get, update, delete - Task management
  - complete - Mark tasks done with auto-scheduling of next occurrence
  - upcoming, due - Query upcoming and currently due tasks
  - history - View completion history
  - stats, health - Reporting
- Typecheck passes
- Files changed:
  - skills/maintenance-scheduler/package.json (new)
  - skills/maintenance-scheduler/tsconfig.json (new)
  - skills/maintenance-scheduler/.gitignore (new)
  - skills/maintenance-scheduler/SKILL.md (new)
  - skills/maintenance-scheduler/src/index.ts (new - main library)
  - skills/maintenance-scheduler/src/cli.ts (new - CLI interface)
- **Learnings for future iterations:**
  - Seasonal templates provide a great onboarding experience - users can quickly get started
  - When completing a task, delete the old reminder and create a new one for the next occurrence
  - calculateNextDue() adds frequencyDays to the current date for the next occurrence
  - Grouping output by category (in list command) improves readability
  - Notice period calculation: daysUntil <= advanceNoticeDays means it's time to notify
  - Template preview allows users to see what they'll get before applying
---

## 2026-02-10 18:41 CET - US-040
- Created flight-search skill - Search and compare flights for travel
- Implemented comprehensive flight search features:
  - Route search between 35 major airports worldwide
  - Price comparison with sorting (price, duration, departure, arrival)
  - Date flexibility with +/- 3 day search
  - Filter by airline codes and maximum stops
  - Cabin class selection (economy, premium_economy, business, first)
  - Round-trip support with separate return flight results
  - Saved searches with SQLite storage
  - Results caching (1 hour TTL)
- Database includes 27 airlines and 35 major airports
- Simulated flight generation when Amadeus API key not available
- Direct booking links to Google Flights, Kayak, and Expedia
- Typecheck passes
- Files changed:
  - skills/flight-search/package.json (new)
  - skills/flight-search/tsconfig.json (new)
  - skills/flight-search/.gitignore (new)
  - skills/flight-search/SKILL.md (new)
  - skills/flight-search/src/index.ts (new)
  - skills/flight-search/src/cli.ts (new)
- **Learnings for future iterations:**
  - Flight search skills can work without external APIs by generating realistic simulated data
  - Use Record<string, number> for multipliers when TypeScript can't infer the type correctly
  - Default values for optional options should be applied when building result objects
  - Provide search engine links as fallback when no API key is available
  - Saved searches pattern is useful for recurring route monitoring
  - Cabin multipliers: economy=1x, premium_economy=1.8x, business=4x, first=8x
  - 35 airport database covers most major US and international destinations
---

## 2026-02-10 18:47 CET - US-041
- Created itinerary-builder skill - Build day-by-day travel itineraries with scheduling and export
- Implemented comprehensive trip planning features:
  - Trip management with destination, dates, and descriptions
  - Day-by-day activity scheduling with start/end times
  - 8 activity categories: transport, sightseeing, food, shopping, entertainment, relaxation, accommodation, other
  - Activity reordering within days (CLI-based "drag-drop")
  - Travel time estimation between activities
  - Cost tracking with currency support
  - Booking reference storage
- Database schema:
  - trips table with full trip metadata
  - activities table with ordering, timing, location, and cost info
- Export functionality:
  - generateHTML() creates professional HTML itineraries
  - exportToHTML() saves to file
  - Styled with CSS, print-friendly, responsive design
- Full CLI with commands:
  - create-trip, list-trips, get-trip, update-trip, delete-trip - Trip management
  - add-activity, list-activities, get-activity, update-activity, delete-activity - Activity management
  - reorder, move - Activity organization
  - schedule - Day-by-day schedule view with travel estimates
  - export - Export to HTML (PDF-ready)
  - stats, health - Monitoring
- Typecheck passes
- Files changed:
  - skills/itinerary-builder/package.json (new)
  - skills/itinerary-builder/tsconfig.json (new)
  - skills/itinerary-builder/.gitignore (new)
  - skills/itinerary-builder/SKILL.md (new)
  - skills/itinerary-builder/src/index.ts (new - main library)
  - skills/itinerary-builder/src/cli.ts (new - CLI interface)
  - prd.json (updated US-041 passes: true)
- **Learnings for future iterations:**
  - SQLite `all<T>()` generic should be the single row type, not array type
  - Travel time estimation can use simple heuristics based on activity categories
  - HTML export with inline CSS is print-friendly and PDF-ready
  - Activity ordering uses order_index field for drag-drop style reordering
  - Day-by-day schedule generation calculates dates from trip start date
---

