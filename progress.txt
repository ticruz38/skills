## 2026-02-10 14:54 CET - US-004
- Created quickbooks-auth skill - QuickBooks OAuth for accounting integration
- Built on top of auth-provider skill for secure token management
- Implemented multi-profile support for multiple QuickBooks companies
- Added support for both sandbox and production environments
- Realm ID is stored in token metadata and accessible via getRealmId()
- Created QuickBooksAuthClient class with initiateAuth, completeAuth, isConnected, getAccessToken, healthCheck, fetch methods
- Implemented CLI with status, connect, complete, disconnect, health, profiles, env commands
- Type-safe environment handling with 'sandbox' | 'production' union type
- Files changed:
  - skills/quickbooks-auth/package.json
  - skills/quickbooks-auth/tsconfig.json
  - skills/quickbooks-auth/.gitignore
  - skills/quickbooks-auth/SKILL.md
  - skills/quickbooks-auth/src/index.ts
  - skills/quickbooks-auth/src/cli.ts
- **Learnings for future iterations:**
  - QuickBooks OAuth requires realmId to be captured from the callback URL and passed to completeAuth()
  - Realm ID is stored in metadata during completeAuth: `this.auth.completeAuth('quickbooks', code, state, { realmId, environment })`
  - Use `realmId || undefined` when returning to satisfy TypeScript's string | undefined type
  - QuickBooks API endpoints require both access token AND realmId in the URL path
  - getApiBaseUrl() returns different URLs for sandbox vs production
---

## 2026-02-10 14:48 CET - US-003
- Created binance-auth skill - Binance API key management for trading skills
- Built on top of auth-provider skill for secure credential storage
- Implemented multi-profile support for multiple Binance accounts
- Added support for both production and testnet environments
- Created BinanceAuthClient class with connect, disconnect, healthCheck, getBalance methods
- Implemented CLI with status, connect, health, list, validate, balance, disconnect commands
- API key validation checks for 64-character hex format
- Files changed:
  - skills/binance-auth/package.json
  - skills/binance-auth/tsconfig.json
  - skills/binance-auth/SKILL.md
  - skills/binance-auth/src/index.ts
  - skills/binance-auth/src/cli.ts
- **Learnings for future iterations:**
  - When auth-provider methods are async (getBinanceClient, getApiKey), need to await them
  - Can instantiate BinanceProviderAdapter directly with credentials for validation before storing
  - Use `await client.isConnected()` since it's now async (checks credentials from storage)
  - Filter non-zero balances with: `.filter((b: {free: string, locked: string}) => parseFloat(b.free) > 0 || parseFloat(b.locked) > 0)`
---

## Codebase Patterns
- Skills are TypeScript-based with `SKILL.md` documentation in frontmatter format
- Use `src/` directory for TypeScript source files
- Use `sqlite3` package (not better-sqlite3) for SQLite - better compatibility
- Encrypt sensitive data with `crypto-js` AES
- Store credentials in `~/.openclaw/skills/{skill-name}/`
- Use environment variables for OAuth client credentials
- Provider adapters implement base interface for OAuth flows
- PKCE is used for all OAuth flows for security
- Multi-profile support via (provider, profile) unique key
- Skills that depend on other skills should use `"@openclaw/auth-provider": "file:../auth-provider"` in package.json
- When extending auth-provider interfaces, export new types (UserProfile) from types.ts
- Async methods in AuthProvider require await when called from dependent skills

---

## 2026-02-10 14:35 CET - US-002
- Created google-oauth skill - Google OAuth adapter for Gmail, Calendar, Drive, Sheets, Docs
- Built on top of auth-provider skill for secure token management
- Replaced existing Python implementation with TypeScript
- Implemented multi-profile support for multiple Google accounts
- Added service-specific scope selection (gmail, calendar, drive, sheets, docs)
- Created CLI with status, connect, complete, disconnect, health, profiles, scopes commands
- Files changed:
  - skills/google-oauth/package.json
  - skills/google-oauth/tsconfig.json
  - skills/google-oauth/SKILL.md
  - skills/google-oauth/src/index.ts
  - skills/google-oauth/src/cli.ts
  - skills/auth-provider/src/types.ts (added UserProfile interface)
  - skills/auth-provider/src/index.ts (added deleteCredentials, listProfiles, getUserProfile)
- **Learnings for future iterations:**
  - Provider adapters can have optional methods like `getUserProfile?` for provider-specific features
  - Use `return token || null` to convert undefined to null for consistent return types
  - CLI commands that call async methods need to be async and use await
---

## 2026-02-10 14:16 CET - US-001
- Created auth-provider skill - foundation for all authentication
- Implemented OAuth 2.0 with PKCE flow
- Created encrypted SQLite storage with AES-256
- Implemented provider adapters: Google, Binance (API key), QuickBooks, Slack
- Added auto-refresh for expiring tokens
- Added health check endpoint for all credentials
- Created CLI for credential management
- Files changed:
  - skills/auth-provider/package.json
  - skills/auth-provider/tsconfig.json
  - skills/auth-provider/SKILL.md
  - skills/auth-provider/src/types.ts
  - skills/auth-provider/src/storage.ts
  - skills/auth-provider/src/index.ts
  - skills/auth-provider/src/cli.ts
  - skills/auth-provider/src/providers/base.ts
  - skills/auth-provider/src/providers/google.ts
  - skills/auth-provider/src/providers/binance.ts
  - skills/auth-provider/src/providers/quickbooks.ts
  - skills/auth-provider/src/providers/slack.ts
  - skills/auth-provider/src/providers/index.ts
- **Learnings for future iterations:**
  - Use `sqlite3` with serialize() for schema initialization to avoid SQLITE_MISUSE
  - Use `crypto-js` for AES encryption - pure JS, no native dependencies
  - Provider adapters should have flexible validateToken signature for provider-specific params
  - Use `fetch` API with explicit type casting: `await response.json() as Type`
  - Store node_modules in .gitignore - don't commit dependencies
---
