â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # Ralph Agent Instructions                                                   â”‚
â”‚                                                                              â”‚
â”‚ You are an autonomous coding agent working on a software project.            â”‚
â”‚                                                                              â”‚
â”‚ ## ğŸ›¡ï¸ CRITICAL SAFETY RULES - NEVER VIOLATE                                   â”‚
â”‚                                                                              â”‚
â”‚ ### System Resource Protection                                               â”‚
â”‚ The following actions are **STRICTLY PROHIBITED** and will cause harm to the â”‚
â”‚ host system:                                                                 â”‚
â”‚                                                                              â”‚
â”‚ **Docker/Container Management:**                                             â”‚
â”‚ - **NEVER** run `docker stop` without an explicit container name or ID       â”‚
â”‚ - **NEVER** use `docker stop $(docker ps -q)` or any pattern that stops mult â”‚
â”‚ iple/all containers                                                          â”‚
â”‚ - **NEVER** run `docker rm -f $(docker ps -aq)` or similar mass-removal comm â”‚
â”‚ ands                                                                         â”‚
â”‚ - **ALWAYS** verify container names with `docker ps --filter name=<pattern>` â”‚
â”‚ before stopping                                                              â”‚
â”‚ - **ONLY** stop containers that were explicitly created by this session      â”‚
â”‚ - **ONLY** stop containers using their explicit name: `docker stop <exact-co â”‚
â”‚ ntainer-name>`                                                               â”‚
â”‚                                                                              â”‚
â”‚ **Process Management:**                                                      â”‚
â”‚ - **NEVER** run `killall`, `pkill`, or similar commands without specific pro â”‚
â”‚ cess names                                                                   â”‚
â”‚ - **NEVER** use `kill -9` on system processes or processes you didn't start  â”‚
â”‚ - **ONLY** terminate processes you explicitly started in this session        â”‚
â”‚                                                                              â”‚
â”‚ **Port/Network Conflicts:**                                                  â”‚
â”‚ - If a port is in use, **USE A DIFFERENT PORT** instead of killing the proce â”‚
â”‚ ss using it                                                                  â”‚
â”‚ - Check what's running on a port with `lsof -i :<port>` or `ss -tlnp | grep  â”‚
â”‚ <port>`                                                                      â”‚
â”‚ - Prefer random/high ports (e.g., `docker run -p 0:8080`) to avoid conflicts â”‚
â”‚                                                                              â”‚
â”‚ **General Safety:**                                                          â”‚
â”‚ - **NEVER** run commands that affect system-wide state unless explicitly req â”‚
â”‚ uired by the PRD                                                             â”‚
â”‚ - **NEVER** use wildcards or glob patterns with destructive commands (`rm`,  â”‚
â”‚ `kill`, `stop`)                                                              â”‚
â”‚ - When in doubt, be explicit and specific with resource names                â”‚
â”‚                                                                              â”‚
â”‚ ---                                                                          â”‚
â”‚                                                                              â”‚
â”‚ ## Your Task                                                                 â”‚
â”‚                                                                              â”‚
â”‚ 1. Read the PRD at `prd.json` (in the same directory as this file)           â”‚
â”‚ 2. Read the progress log at `progress.txt` (check Codebase Patterns section  â”‚
â”‚ first)                                                                       â”‚
â”‚ 3. Check you're on the correct branch from PRD `branchName`. If not, check i â”‚
â”‚ t out or create from main.                                                   â”‚
â”‚ 4. Pick the **highest priority** user story where `passes: false`            â”‚
â”‚ 5. Implement that single user story                                          â”‚
â”‚ 6. Run quality checks (e.g., typecheck, lint, test - use whatever your proje â”‚
â”‚ ct requires)                                                                 â”‚
â”‚ 7. Update AGENTS.md files if you discover reusable patterns (see below)      â”‚
â”‚ 8. If checks pass, commit ALL changes with message: `feat: [Story ID] - [Sto â”‚
â”‚ ry Title]`                                                                   â”‚
â”‚ 9. Update the PRD to set `passes: true` for the completed story              â”‚
â”‚ 10. Append your progress to `progress.txt`                                   â”‚
â”‚                                                                              â”‚
â”‚ ## Progress Report Format                                                    â”‚
â”‚                                                                              â”‚
â”‚ APPEND to progress.txt (never replace, always append):                       â”‚
â”‚ ```                                                                          â”‚
â”‚ ## [Date/Time] - [Story ID]                                                  â”‚
â”‚ - What was implemented                                                       â”‚
â”‚ - Files changed                                                              â”‚
â”‚ - **Learnings for future iterations:**                                       â”‚
â”‚   - Patterns discovered (e.g., "this codebase uses X for Y")                 â”‚
â”‚   - Gotchas encountered (e.g., "don't forget to update Z when changing W")   â”‚
â”‚   - Useful context (e.g., "the evaluation panel is in component X")          â”‚
â”‚ ---                                                                          â”‚
â”‚ ```                                                                          â”‚
â”‚                                                                              â”‚
â”‚ The learnings section is critical - it helps future iterations avoid repeati â”‚
â”‚ ng mistakes and understand the codebase better.                              â”‚
â”‚                                                                              â”‚
â”‚ ## Consolidate Patterns                                                      â”‚
â”‚                                                                              â”‚
â”‚ If you discover a **reusable pattern** that future iterations should know, a â”‚
â”‚ dd it to the `## Codebase Patterns` section at the TOP of progress.txt (crea â”‚
â”‚ te it if it doesn't exist). This section should consolidate the most importa â”‚
â”‚ nt learnings:                                                                â”‚
â”‚                                                                              â”‚
â”‚ ```                                                                          â”‚
â”‚ ## Codebase Patterns                                                         â”‚
â”‚ - Example: Use `sql<number>` template for aggregations                       â”‚
â”‚ - Example: Always use `IF NOT EXISTS` for migrations                         â”‚
â”‚ - Example: Export types from actions.ts for UI components                    â”‚
â”‚ ```                                                                          â”‚
â”‚                                                                              â”‚
â”‚ Only add patterns that are **general and reusable**, not story-specific deta â”‚
â”‚ ils.                                                                         â”‚
â”‚                                                                              â”‚
â”‚ ## Update AGENTS.md Files                                                    â”‚
â”‚                                                                              â”‚
â”‚ Before committing, check if any edited files have learnings worth preserving â”‚
â”‚ in nearby AGENTS.md files:                                                   â”‚
â”‚                                                                              â”‚
â”‚ 1. **Identify directories with edited files** - Look at which directories yo â”‚
â”‚ u modified                                                                   â”‚
â”‚ 2. **Check for existing AGENTS.md** - Look for AGENTS.md in those directorie â”‚
â”‚ s or parent directories                                                      â”‚
â”‚ 3. **Add valuable learnings** - If you discovered something future developer â”‚
â”‚ s/agents should know:                                                        â”‚
â”‚    - API patterns or conventions specific to that module                     â”‚
â”‚    - Gotchas or non-obvious requirements                                     â”‚
â”‚    - Dependencies between files                                              â”‚
â”‚    - Testing approaches for that area                                        â”‚
â”‚    - Configuration or environment requirements                               â”‚
â”‚                                                                              â”‚
â”‚ **Examples of good AGENTS.md additions:**                                    â”‚
â”‚ - "When modifying X, also update Y to keep them in sync"                     â”‚
â”‚ - "This module uses pattern Z for all API calls"                             â”‚
â”‚ - "Tests require the dev server running on PORT 3000"                        â”‚
â”‚ - "Field names must match the template exactly"                              â”‚
â”‚                                                                              â”‚
â”‚ **Do NOT add:**                                                              â”‚
â”‚ - Story-specific implementation details                                      â”‚
â”‚ - Temporary debugging notes                                                  â”‚
â”‚ - Information already in progress.txt                                        â”‚
â”‚                                                                              â”‚
â”‚ Only update AGENTS.md if you have **genuinely reusable knowledge** that woul â”‚
â”‚ d help future work in that directory.                                        â”‚
â”‚                                                                              â”‚
â”‚ ## Quality Requirements                                                      â”‚
â”‚                                                                              â”‚
â”‚ - ALL commits must pass your project's quality checks (typecheck, lint, test â”‚
â”‚ )                                                                            â”‚
â”‚ - Do NOT commit broken code                                                  â”‚
â”‚ - Keep changes focused and minimal                                           â”‚
â”‚ - Follow existing code patterns                                              â”‚
â”‚                                                                              â”‚
â”‚ ## Browser Testing (Required for Frontend Stories)                           â”‚
â”‚                                                                              â”‚
â”‚ For any story that changes UI, you MUST verify it works in the browser:      â”‚
â”‚                                                                              â”‚
â”‚ 1. Load the `dev-browser` skill                                              â”‚
â”‚ 2. Navigate to the relevant page                                             â”‚
â”‚ 3. Verify the UI changes work as expected                                    â”‚
â”‚ 4. Take a screenshot if helpful for the progress log                         â”‚
â”‚                                                                              â”‚
â”‚ A frontend story is NOT complete until browser verification passes.          â”‚
â”‚                                                                              â”‚
â”‚ ## Stop Condition                                                            â”‚
â”‚                                                                              â”‚
â”‚ After completing a user story, check if ALL stories have `passes: true`.     â”‚
â”‚                                                                              â”‚
â”‚ If ALL stories are complete and passing, reply with:                         â”‚
â”‚ <promise>COMPLETE</promise>                                                  â”‚
â”‚                                                                              â”‚
â”‚ If there are still stories with `passes: false`, end your response normally  â”‚
â”‚ (another iteration will pick up the next story).                             â”‚
â”‚                                                                              â”‚
â”‚ ## Important                                                                 â”‚
â”‚                                                                              â”‚
â”‚ - Work on ONE story per iteration                                            â”‚
â”‚ - Commit frequently                                                          â”‚
â”‚ - Keep CI green                                                              â”‚
â”‚ - Read the Codebase Patterns section in progress.txt before starting         â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
â€¢ Let me start by reading the PRD file and progress log to understand what needs
  to be done.
â€¢ Used ReadFile (prd.json)
â€¢ Used ReadFile (progress.txt)
â€¢ The progress log is quite long. Let me continue reading it to see the current
  state, and also check the prd.json to find the highest priority story with pas
  ses: false.
â€¢ Used ReadFile (progress.txt)
â€¢ Used Shell (cd /root/code/skills && git status)
â€¢ Now I need to find the highest priority user story with passes: false. From th
  e PRD, I can see that US-043 through US-060 are still pending (passes: false).
  Let me pick the highest priority one - which is US-043 "Create client-crm skil
  l for realtor contacts".

  Let me verify the current branch and start implementing US-043.
â€¢ Now I can see the status. Let me find the highest priority story with passes:
  false:
â€¢ Used Shell (cd /root/code/skills && n...ty:', highest.priority);")
â€¢ Used Glob (skills/*)
â€¢ I need to implement US-043: "Create client-crm skill for realtor contacts". Th
  is is a real estate client relationship management skill. Let me check the pro
  gress.txt for patterns and check if there's an existing skill structure to fol
  low.

  The skill should:

  â€¢ Contact profiles
  â€¢ Property preferences
  â€¢ Communication history
  â€¢ Pipeline tracking

  It's noted that this is "SQLite storage. No external deps".

  Let me check the progress.txt for patterns from similar skills, and look at so
  me existing skills for reference.
â€¢ I'll implement US-043: Create client-crm skill for realtor contacts. Let me ch
  eck the patterns and reference similar skills:
â€¢ Used ReadFile (skills/client-tracker/src/index.ts)
â€¢ Used ReadFile (property-alerts/src/index.ts)
  File not found
â€¢ Let me check the structure of the property-alerts skill and look at other simi
  lar skills.
â€¢ Used Glob (skills/property-alerts/*)
â€¢ Used ReadFile (skills/property-alerts/src/index.ts)
â€¢ Now I have a good understanding of the patterns. Let me create the client-crm
  skill for realtor contacts. Based on the PRD requirements:

  â€¢ Contact profiles
  â€¢ Property preferences
  â€¢ Communication history
  â€¢ Pipeline tracking
  â€¢ SQLite storage
  â€¢ No external deps

  Let me create this skill now.
â€¢ Now I have a good understanding of the patterns. Let me create the client-crm
  skill for real estate agents:
â€¢ Used Shell (mkdir -p /root/code/skills/skills/client-crm/src)
â€¢ Now let me create the SKILL.md file for the client-crm skill.
â€¢ Used WriteFile (skills/client-crm/SKILL.md)
â€¢ Now let me create the main TypeScript implementation file for the client-crm s
  kill.
â€¢ Used WriteFile (skills/client-crm/src/index.ts)
â€¢ Now let me create the CLI file for the client-crm skill.
â€¢ Used WriteFile (skills/client-crm/src/cli.ts)
â€¢ Now let me create the package.json and tsconfig.json files for the client-crm
  skill.
â€¢ Used WriteFile (skills/client-crm/package.json)
â€¢ Now let me create the tsconfig.json file.
â€¢ Used WriteFile (skills/client-crm/tsconfig.json)
â€¢ Now let me create the .gitignore file.
â€¢ Used WriteFile (skills/client-crm/.gitignore)
â€¢ Now let me build the skill to ensure it compiles correctly.
â€¢ Used Shell (cd /root/code/skills/skil...&& npm run typecheck 2>&1)
â€¢ The typecheck passed. Now let me build the project and run a quick test.
â€¢ Typecheck passes! Let me build the project and test it:
â€¢ Used Shell (cd /root/code/skills/skil...crm && npm run build 2>&1)
â€¢ Build succeeded. Let me test the CLI to make sure it works.
â€¢ Used Shell (cd /root/code/skills/skil...e dist/cli.js health 2>&1)
  Failed with exit code: 1
â€¢ Used Shell (cd /root/code/skills/skil... lead --urgency high 2>&1)
  Failed with exit code: 1
â€¢ There's an issue with how I'm importing sqlite3. Let me fix that. The issue is
  with ES modules and the sqlite3 import.
â€¢ I need to fix the sqlite3 import for ES modules:
â€¢ Used StrReplaceFile (skills/client-crm/src/index.ts)
â€¢ I also need to update the tsconfig to allow default imports and update the pac
  kage.json to enable esModuleInterop. Let me check the existing skills' configu
  ration.
â€¢ Used ReadFile (skills/client-tracker/tsconfig.json)
â€¢ The tsconfig looks the same. Let me check how the client-tracker skill handles
  the sqlite3 import:
â€¢ Used Shell (head -20 /root/code/skill...ient-tracker/src/index.ts)
â€¢ I see - client-tracker uses import * as sqlite3 from 'sqlite3' but it's a Comm
  onJS project, not ES module. Let me check if client-tracker is using CommonJS
  or ES modules.
â€¢ Used Shell (cat /root/code/skills/ski...json | grep -A 5 '"type"')
  Failed with exit code: 1
â€¢ Let me check if there's a type field in the package.json
â€¢ Used ReadFile (skills/client-tracker/package.json)
â€¢ Ah, I see - client-tracker doesn't have "type": "module" so it's CommonJS. My
  skill has "type": "module" which makes it an ES module. The way to use sqlite3
  with ES modules is different.

  Let me check how other ES module skills handle this.
â€¢ Used Shell (cat /root/code/skills/ski...s/package.json | head -15)
â€¢ Let me check if property-alerts has type:module
â€¢ Used Shell (cat /root/code/skills/ski...perty-alerts/package.json)
â€¢ It doesn't have type:module either. Let me check how the skill actually import
  s sqlite3 in its code.
â€¢ Used Shell (head -10 /root/code/skill...perty-alerts/src/index.ts)
â€¢ I see, property-alerts uses import * as sqlite3 from 'sqlite3' and doesn't use
  "type": "module". So it's a CommonJS module. Let me remove the "type": "module
  " from my package.json and add @types/sqlite3 as a dev dependency.
â€¢ Let me fix the module type - I'll make it CommonJS like other skills:
â€¢ Used StrReplaceFile (skills/client-crm/package.json)
â€¢ Now I need to update the tsconfig to use CommonJS modules instead of NodeNext.
â€¢ Used StrReplaceFile (skills/client-crm/tsconfig.json)
â€¢ Now I need to revert the sqlite3 import back to the namespace import and add @
  types/sqlite3 as a dev dependency. Also, I need to update the import in the CL
  I file.
â€¢ Used StrReplaceFile (skills/client-crm/src/index.ts)
â€¢ Used StrReplaceFile (skills/client-crm/src/cli.ts)
â€¢ Used StrReplaceFile (skills/client-crm/package.json)
â€¢ Now let me rebuild and test again.
â€¢ Used Shell (cd /root/code/skills/skil...all && npm run build 2>&1)
â€¢ Build succeeded. Now let me test it.
â€¢ Used Shell (cd /root/code/skills/skil...e dist/cli.js health 2>&1)
â€¢ Health check works! Now let me test adding a client and some other operations.
â€¢ Used Shell (cd /root/code/skills/skil... lead --urgency high 2>&1)
â€¢ Excellent! Let me test more commands.
â€¢ Used Shell (cd /root/code/skills/skil... --budget-max 600000 2>&1)
â€¢ Let me test more commands to verify the full functionality.
â€¢ Used Shell (cd /root/code/skills/skil...de dist/cli.js get 1 2>&1)
â€¢ Let me test preferences and communications.
â€¢ Used Shell (cd /root/code/skills/skil...ckyard,good schools" 2>&1)
â€¢ Let me test communications, pipeline updates, and other features.
â€¢ Used Shell (cd /root/code/skills/skil...ne 1 --stage viewing 2>&1)
â€¢ Let me test stats, follow-ups, and other features.
â€¢ Used Shell (cd /root/code/skills/skil...de dist/cli.js stats 2>&1)
â€¢ Excellent! All functionality is working. Let me test follow-ups and search.
â€¢ Used Shell (cd /root/code/skills/skil...follow-ups --days 10 2>&1)
â€¢ Everything is working correctly. Let me test a few more features like search a
  nd by-location.
â€¢ Used Shell (cd /root/code/skills/skil...by-location "Austin" 2>&1)
â€¢ Excellent! All features are working. Now let me run the typecheck again and up
  date the PRD.
â€¢ Used Shell (cd /root/code/skills/skil...&& npm run typecheck 2>&1)
â€¢ All checks pass. Now let me update the PRD to set US-043 passes: true and comm
  it the changes.
â€¢ Now let me update the PRD and commit the changes:
â€¢ Used StrReplaceFile (prd.json)
â€¢ Now let me commit the changes.
â€¢ Used Shell (cd /root/code/skills && g...or realtor contacts" 2>&1)
â€¢ Now let me append the progress to progress.txt.
â€¢ Used WriteFile (progress.txt)
â€¢ Now let me check if there are more stories to complete.
â€¢ Let me check the remaining stories:
â€¢ Used Shell (cd /root/code/skills && n...og(s.id, '-', s.title));")
â€¢ 17 stories remaining. Let me verify everything is committed and summarize what
  was done.
â€¢ Used Shell (cd /root/code/skills && git status)
â€¢ I need to commit the progress.txt changes too.
â€¢ Used Shell (cd /root/code/skills && g...progress for US-043" 2>&1)
â€¢ All changes are committed. Let me verify the current status.
â€¢ Used Shell (cd /root/code/skills && g...pleted/total*100)}%)\`);")
â€¢ 43 out of 60 stories are completed (72%). There are still 17 stories remaining
  . I should report the successful completion of US-043.
â€¢ âœ… US-043 Completed: Client CRM Skill

  I have successfully implemented the client-crm skill for real estate client re
  lationship management. Here's a summary:

  What was implemented:

  Features:

  â€¢ Contact profiles - Name, email, phone, address, client type (buyer/seller/re
    er/investor/vendor/other)
  â€¢ Property preferences - Price range, bedrooms, bathrooms, sqft, locations, pr
    erty types, must-have/nice-to-have features
  â€¢ Communication history - Track calls, emails, meetings, showings, texts, note
  â€¢ Pipeline tracking - 7 stages: lead â†’ qualified â†’ viewing â†’ offer â†’ under_con
    act â†’ closed â†’ archived
  â€¢ Urgency levels - low, medium, high, urgent
  â€¢ Follow-up management - Set follow-up dates with automatic upcoming reminders
  â€¢ Search capabilities - Text search, location-based search, feature-based sear
  â€¢ Statistics & reporting - Pipeline stats, client breakdowns, total pipeline v
    ue
  â€¢ CSV import/export - Data portability

  CLI Commands:

  client-crm add/list/get/update/delete    # Client management
  client-crm search                        # Text search
  client-crm pipeline/pipeline-list        # Pipeline management
  client-crm preferences/preferences-get   # Property preferences
  client-crm log/communications            # Communication tracking
  client-crm follow-ups/set-follow-up      # Follow-up management
  client-crm by-location/by-feature        # Preference search
  client-crm export/import                 # Data exchange
  client-crm stats/health                  # Reporting

  Technical Details:

  â€¢ TypeScript with SQLite storage
  â€¢ 3 database tables: clients, preferences, communications
  â€¢ JSON arrays for flexible location/type/feature storage
  â€¢ Full typecheck passes
  â€¢ CommonJS module format (consistent with other skills)

  Progress:

  â€¢ 43/60 stories completed (72%)
  â€¢ 17 stories remaining
