â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # Ralph Agent Instructions                                                   â”‚
â”‚                                                                              â”‚
â”‚ You are an autonomous coding agent working on a software project.            â”‚
â”‚                                                                              â”‚
â”‚ ## ğŸ›¡ï¸ CRITICAL SAFETY RULES - NEVER VIOLATE                                   â”‚
â”‚                                                                              â”‚
â”‚ ### System Resource Protection                                               â”‚
â”‚ The following actions are **STRICTLY PROHIBITED** and will cause harm to the â”‚
â”‚ host system:                                                                 â”‚
â”‚                                                                              â”‚
â”‚ **Docker/Container Management:**                                             â”‚
â”‚ - **NEVER** run `docker stop` without an explicit container name or ID       â”‚
â”‚ - **NEVER** use `docker stop $(docker ps -q)` or any pattern that stops mult â”‚
â”‚ iple/all containers                                                          â”‚
â”‚ - **NEVER** run `docker rm -f $(docker ps -aq)` or similar mass-removal comm â”‚
â”‚ ands                                                                         â”‚
â”‚ - **ALWAYS** verify container names with `docker ps --filter name=<pattern>` â”‚
â”‚ before stopping                                                              â”‚
â”‚ - **ONLY** stop containers that were explicitly created by this session      â”‚
â”‚ - **ONLY** stop containers using their explicit name: `docker stop <exact-co â”‚
â”‚ ntainer-name>`                                                               â”‚
â”‚                                                                              â”‚
â”‚ **Process Management:**                                                      â”‚
â”‚ - **NEVER** run `killall`, `pkill`, or similar commands without specific pro â”‚
â”‚ cess names                                                                   â”‚
â”‚ - **NEVER** use `kill -9` on system processes or processes you didn't start  â”‚
â”‚ - **ONLY** terminate processes you explicitly started in this session        â”‚
â”‚                                                                              â”‚
â”‚ **Port/Network Conflicts:**                                                  â”‚
â”‚ - If a port is in use, **USE A DIFFERENT PORT** instead of killing the proce â”‚
â”‚ ss using it                                                                  â”‚
â”‚ - Check what's running on a port with `lsof -i :<port>` or `ss -tlnp | grep  â”‚
â”‚ <port>`                                                                      â”‚
â”‚ - Prefer random/high ports (e.g., `docker run -p 0:8080`) to avoid conflicts â”‚
â”‚                                                                              â”‚
â”‚ **General Safety:**                                                          â”‚
â”‚ - **NEVER** run commands that affect system-wide state unless explicitly req â”‚
â”‚ uired by the PRD                                                             â”‚
â”‚ - **NEVER** use wildcards or glob patterns with destructive commands (`rm`,  â”‚
â”‚ `kill`, `stop`)                                                              â”‚
â”‚ - When in doubt, be explicit and specific with resource names                â”‚
â”‚                                                                              â”‚
â”‚ ---                                                                          â”‚
â”‚                                                                              â”‚
â”‚ ## Your Task                                                                 â”‚
â”‚                                                                              â”‚
â”‚ 1. Read the PRD at `prd.json` (in the same directory as this file)           â”‚
â”‚ 2. Read the progress log at `progress.txt` (check Codebase Patterns section  â”‚
â”‚ first)                                                                       â”‚
â”‚ 3. Check you're on the correct branch from PRD `branchName`. If not, check i â”‚
â”‚ t out or create from main.                                                   â”‚
â”‚ 4. Pick the **highest priority** user story where `passes: false`            â”‚
â”‚ 5. Implement that single user story                                          â”‚
â”‚ 6. Run quality checks (e.g., typecheck, lint, test - use whatever your proje â”‚
â”‚ ct requires)                                                                 â”‚
â”‚ 7. Update AGENTS.md files if you discover reusable patterns (see below)      â”‚
â”‚ 8. If checks pass, commit ALL changes with message: `feat: [Story ID] - [Sto â”‚
â”‚ ry Title]`                                                                   â”‚
â”‚ 9. Update the PRD to set `passes: true` for the completed story              â”‚
â”‚ 10. Append your progress to `progress.txt`                                   â”‚
â”‚                                                                              â”‚
â”‚ ## Progress Report Format                                                    â”‚
â”‚                                                                              â”‚
â”‚ APPEND to progress.txt (never replace, always append):                       â”‚
â”‚ ```                                                                          â”‚
â”‚ ## [Date/Time] - [Story ID]                                                  â”‚
â”‚ - What was implemented                                                       â”‚
â”‚ - Files changed                                                              â”‚
â”‚ - **Learnings for future iterations:**                                       â”‚
â”‚   - Patterns discovered (e.g., "this codebase uses X for Y")                 â”‚
â”‚   - Gotchas encountered (e.g., "don't forget to update Z when changing W")   â”‚
â”‚   - Useful context (e.g., "the evaluation panel is in component X")          â”‚
â”‚ ---                                                                          â”‚
â”‚ ```                                                                          â”‚
â”‚                                                                              â”‚
â”‚ The learnings section is critical - it helps future iterations avoid repeati â”‚
â”‚ ng mistakes and understand the codebase better.                              â”‚
â”‚                                                                              â”‚
â”‚ ## Consolidate Patterns                                                      â”‚
â”‚                                                                              â”‚
â”‚ If you discover a **reusable pattern** that future iterations should know, a â”‚
â”‚ dd it to the `## Codebase Patterns` section at the TOP of progress.txt (crea â”‚
â”‚ te it if it doesn't exist). This section should consolidate the most importa â”‚
â”‚ nt learnings:                                                                â”‚
â”‚                                                                              â”‚
â”‚ ```                                                                          â”‚
â”‚ ## Codebase Patterns                                                         â”‚
â”‚ - Example: Use `sql<number>` template for aggregations                       â”‚
â”‚ - Example: Always use `IF NOT EXISTS` for migrations                         â”‚
â”‚ - Example: Export types from actions.ts for UI components                    â”‚
â”‚ ```                                                                          â”‚
â”‚                                                                              â”‚
â”‚ Only add patterns that are **general and reusable**, not story-specific deta â”‚
â”‚ ils.                                                                         â”‚
â”‚                                                                              â”‚
â”‚ ## Update AGENTS.md Files                                                    â”‚
â”‚                                                                              â”‚
â”‚ Before committing, check if any edited files have learnings worth preserving â”‚
â”‚ in nearby AGENTS.md files:                                                   â”‚
â”‚                                                                              â”‚
â”‚ 1. **Identify directories with edited files** - Look at which directories yo â”‚
â”‚ u modified                                                                   â”‚
â”‚ 2. **Check for existing AGENTS.md** - Look for AGENTS.md in those directorie â”‚
â”‚ s or parent directories                                                      â”‚
â”‚ 3. **Add valuable learnings** - If you discovered something future developer â”‚
â”‚ s/agents should know:                                                        â”‚
â”‚    - API patterns or conventions specific to that module                     â”‚
â”‚    - Gotchas or non-obvious requirements                                     â”‚
â”‚    - Dependencies between files                                              â”‚
â”‚    - Testing approaches for that area                                        â”‚
â”‚    - Configuration or environment requirements                               â”‚
â”‚                                                                              â”‚
â”‚ **Examples of good AGENTS.md additions:**                                    â”‚
â”‚ - "When modifying X, also update Y to keep them in sync"                     â”‚
â”‚ - "This module uses pattern Z for all API calls"                             â”‚
â”‚ - "Tests require the dev server running on PORT 3000"                        â”‚
â”‚ - "Field names must match the template exactly"                              â”‚
â”‚                                                                              â”‚
â”‚ **Do NOT add:**                                                              â”‚
â”‚ - Story-specific implementation details                                      â”‚
â”‚ - Temporary debugging notes                                                  â”‚
â”‚ - Information already in progress.txt                                        â”‚
â”‚                                                                              â”‚
â”‚ Only update AGENTS.md if you have **genuinely reusable knowledge** that woul â”‚
â”‚ d help future work in that directory.                                        â”‚
â”‚                                                                              â”‚
â”‚ ## Quality Requirements                                                      â”‚
â”‚                                                                              â”‚
â”‚ - ALL commits must pass your project's quality checks (typecheck, lint, test â”‚
â”‚ )                                                                            â”‚
â”‚ - Do NOT commit broken code                                                  â”‚
â”‚ - Keep changes focused and minimal                                           â”‚
â”‚ - Follow existing code patterns                                              â”‚
â”‚                                                                              â”‚
â”‚ ## Browser Testing (Required for Frontend Stories)                           â”‚
â”‚                                                                              â”‚
â”‚ For any story that changes UI, you MUST verify it works in the browser:      â”‚
â”‚                                                                              â”‚
â”‚ 1. Load the `dev-browser` skill                                              â”‚
â”‚ 2. Navigate to the relevant page                                             â”‚
â”‚ 3. Verify the UI changes work as expected                                    â”‚
â”‚ 4. Take a screenshot if helpful for the progress log                         â”‚
â”‚                                                                              â”‚
â”‚ A frontend story is NOT complete until browser verification passes.          â”‚
â”‚                                                                              â”‚
â”‚ ## Stop Condition                                                            â”‚
â”‚                                                                              â”‚
â”‚ After completing a user story, check if ALL stories have `passes: true`.     â”‚
â”‚                                                                              â”‚
â”‚ If ALL stories are complete and passing, reply with:                         â”‚
â”‚ <promise>COMPLETE</promise>                                                  â”‚
â”‚                                                                              â”‚
â”‚ If there are still stories with `passes: false`, end your response normally  â”‚
â”‚ (another iteration will pick up the next story).                             â”‚
â”‚                                                                              â”‚
â”‚ ## Important                                                                 â”‚
â”‚                                                                              â”‚
â”‚ - Work on ONE story per iteration                                            â”‚
â”‚ - Commit frequently                                                          â”‚
â”‚ - Keep CI green                                                              â”‚
â”‚ - Read the Codebase Patterns section in progress.txt before starting         â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
â€¢ The user wants me to work as an autonomous coding agent on a software project.
  Let me start by:

  1. Reading the PRD at prd.json
  2. Reading the progress log at progress.txt
  3. Checking the branch and implementing the highest priority user story that d
     n't pass yet

  Let me start by reading these files.
â€¢ I'll start by reading the PRD and progress files to understand what needs to b
  e implemented.
â€¢ Used ReadFile (prd.json)
â€¢ Used ReadFile (progress.txt)
â€¢ Let me continue reading the progress.txt to see all the patterns and check for
  the highest priority story that doesn't pass yet.
â€¢ Let me continue reading the progress.txt file to see all patterns and find the
  next story to implement.
â€¢ Used ReadFile (progress.txt)
â€¢ Let me continue reading the progress.txt to see the remaining patterns and ide
  ntify the next story to implement.
â€¢ Let me continue reading progress.txt and check the current git branch:
â€¢ Used ReadFile (progress.txt)
â€¢ Used Shell (cd /root/code/skills && git branch --show-current)
â€¢ Looking at the PRD, I need to identify the highest priority user story with pa
  sses: false. Let me analyze the prd.json:

  From the PRD:

  â€¢ US-001 to US-050 have passes: true
  â€¢ US-051 (focus-time-blocks skill) - priority 51, passes: false
  â€¢ US-052 (report-builder skill) - priority 52, passes: false
  â€¢ US-053 (monthly-reports skill) - priority 53, passes: false
  â€¢ US-054 (competitor-monitor skill) - priority 54, passes: false
  â€¢ US-055 (email-summarizer skill) - priority 55, passes: false
  â€¢ US-056 (showing-scheduler skill) - priority 56, passes: false
  â€¢ US-057 (pantry-tracker skill) - priority 57, passes: false
  â€¢ US-058 (diy-guides skill) - priority 58, passes: false
  â€¢ US-059 (review-monitor skill) - priority 59, passes: false
  â€¢ US-060 (saved-searches skill) - priority 60, passes: false

  The highest priority story that doesn't pass is US-051: "Create focus-time-blo
  cks skill for deep work"

  Let me check what this skill needs:

  â€¢ US-051: Create focus-time-blocks skill for deep work
    â€¢ Priority: 51
    â€¢ Depends: calendar
    â€¢ Uses model for suggestions
    â€¢ Acceptance Criteria:
      â€¢ Recurring focus blocks
      â€¢ Auto-decline meetings
      â€¢ DND integration
      â€¢ Productivity analytics
      â€¢ Typecheck passes

  I'm currently on the correct branch ralph/all-skills. Now I need to implement
  this skill. Let me look at the existing calendar skill to understand how to in
  tegrate with it.
â€¢ I can see I'm on the correct branch ralph/all-skills. Looking at the PRD, the
  highest priority story that doesn't pass is US-051: Create focus-time-blocks s
  kill for deep work (priority 51).

  Let me check the existing calendar skill structure to understand the integrati
  on pattern:
â€¢ Used Glob (skills/calendar/src/*.ts)
â€¢ Used Shell (ls -la skills/)
â€¢ I can see the focus-time-blocks skill doesn't exist yet. Let me read the calen
  dar skill to understand the integration pattern and then create the focus-time
  -blocks skill.
â€¢ Let me read the calendar skill to understand the integration pattern:
â€¢ Used ReadFile (skills/calendar/src/index.ts)
â€¢ Used ReadFile (skills/calendar/package.json)
â€¢ I have the requirements for the focus-time-blocks skill: recurring focus block
  s, auto-decline meetings, DND integration, and productivity analytics. Now I n
  eed to set up the project. Hmm, looking at the existing skills, they follow a
  very specific structure with package.json and tsconfig.json. If I don't mirror
  this, the integration will fail. Wait, I should establish a clear plan before
  I start generating files. I'll define the file structure and the technical req
  uirements. I'll start by initializing a todo list to track the setup of the di
  rectory and configuration files.
â€¢ Now I understand the pattern. Let me create the focus-time-blocks skill. I'll
  set up the todo list and implement the skill.
â€¢ Used SetTodoList
  â€¢ Create skill directory structure and config files â†
  â€¢ Implement focus-time-blocks skill library (index.ts)
  â€¢ Implement CLI interface (cli.ts)
  â€¢ Run typecheck and fix any issues
  â€¢ Update progress.txt and prd.json
  â€¢ Commit changes
â€¢ Used Shell (mkdir -p /root/code/skill...lls/focus-time-blocks/src)
â€¢ Now let me create the focus-time-blocks skill files.
â€¢ Used WriteFile (skills/focus-time-blocks/package.json)
â€¢ Used WriteFile (skills/focus-time-blocks/tsconfig.json)
â€¢ Used WriteFile (skills/focus-time-blocks/.gitignore)
â€¢ Now let me create the main index.ts file for the focus-time-blocks skill. This
  will implement:

  1. Recurring focus blocks
  2. Auto-decline meetings
  3. DND integration (marking events as busy/transparent)
  4. Productivity analytics
â€¢ Used WriteFile (skills/focus-time-blocks/src/index.ts)
â€¢ Now let me create the CLI file.
â€¢ Used WriteFile (skills/focus-time-blocks/src/cli.ts)
â€¢ Now I need to create the SKILL.md file and then run typecheck.
â€¢ Used WriteFile (skills/focus-time-blocks/SKILL.md)
â€¢ Used SetTodoList
  â€¢ Create skill directory structure and config files
  â€¢ Implement focus-time-blocks skill library (index.ts)
  â€¢ Implement CLI interface (cli.ts)
  â€¢ Run typecheck and fix any issues â†
  â€¢ Update progress.txt and prd.json
  â€¢ Commit changes
â€¢ Now let me run typecheck to verify the code compiles correctly.
â€¢ Used Shell (cd /root/code/skills/skil...locks && npm install 2>&1)
â€¢ Good, dependencies installed. Now let's run typecheck.
â€¢ Used Shell (cd /root/code/skills/skil...&& npm run typecheck 2>&1)
â€¢ Typecheck passes! Now let me build the skill and then update the progress.txt
  and prd.json.
â€¢ Typecheck passes! Let me build the skill and update the progress tracking:
â€¢ Used Shell (cd /root/code/skills/skil...cks && npm run build 2>&1)
â€¢ Used SetTodoList
  â€¢ Create skill directory structure and config files
  â€¢ Implement focus-time-blocks skill library (index.ts)
  â€¢ Implement CLI interface (cli.ts)
  â€¢ Run typecheck and fix any issues
  â€¢ Update progress.txt and prd.json â†
  â€¢ Commit changes
â€¢ Now let me update the prd.json to mark US-051 as passing, and append to progre
  ss.txt.
â€¢ Now let me update the PRD and progress.txt:
â€¢ Used StrReplaceFile (prd.json)
â€¢ Now let me append to progress.txt.
â€¢ Used WriteFile (progress.txt)
â€¢ Now let me commit the changes.
â€¢ Used Shell (cd /root/code/skills && git add -A && git status)
â€¢ Now let me commit the changes.
â€¢ Used Shell (cd /root/code/skills && g...skill for deep work" 2>&1)
â€¢ Used SetTodoList
  â€¢ Create skill directory structure and config files
  â€¢ Implement focus-time-blocks skill library (index.ts)
  â€¢ Implement CLI interface (cli.ts)
  â€¢ Run typecheck and fix any issues
  â€¢ Update progress.txt and prd.json
  â€¢ Commit changes
â€¢ I've completed US-051. Let me check if there are more stories that need to be
  done. Looking at the PRD, the remaining stories with passes: false are:

  â€¢ US-052: report-builder skill
  â€¢ US-053: monthly-reports skill
  â€¢ US-054: competitor-monitor skill
  â€¢ US-055: email-summarizer skill
  â€¢ US-056: showing-scheduler skill
  â€¢ US-057: pantry-tracker skill
  â€¢ US-058: diy-guides skill
  â€¢ US-059: review-monitor skill
  â€¢ US-060: saved-searches skill

  Since there are still stories to complete, I should end my response normally w
  ithout the COMPLETE promise.
â€¢ I've successfully completed US-051: Create focus-time-blocks skill for deep wo
  rk.

  Summary

  Created the focus-time-blocks skill with the following features:

  Features Implemented

  1. Recurring Focus Blocks - Schedule customizable deep work sessions with:
    â€¢ Days of week selection
    â€¢ Start/end times
    â€¢ Duration tracking
    â€¢ Color coding for calendar events
  2. Auto-Decline Meetings - Rules-based system for:
    â€¢ Pattern matching on meeting titles
    â€¢ Organizer-based rules
    â€¢ Custom decline messages
  3. DND Integration - Calendar visibility settings:
    â€¢ Events marked as "private"
    â€¢ Busy status during focus time
    â€¢ Popup reminders 5 minutes before
  4. Productivity Analytics - Comprehensive tracking:
    â€¢ Total sessions, completion rate
    â€¢ Focus hours, interruptions
    â€¢ Weekly trends (4 weeks)
    â€¢ Daily distribution patterns

  Files Created

  â€¢ skills/focus-time-blocks/package.json
  â€¢ skills/focus-time-blocks/tsconfig.json
  â€¢ skills/focus-time-blocks/.gitignore
  â€¢ skills/focus-time-blocks/SKILL.md
  â€¢ skills/focus-time-blocks/src/index.ts (main library)
  â€¢ skills/focus-time-blocks/src/cli.ts (CLI interface)

  Database Schema

  â€¢ focus_blocks - Block configurations
  â€¢ productivity_sessions - Session tracking with status
  â€¢ auto_decline_rules - Meeting decline rules

  Default Templates

  â€¢ Morning Deep Work (Mon-Fri 9-11am)
  â€¢ Afternoon Focus (Mon-Fri 2-3:30pm)
  â€¢ Creative Session (Tue/Thu 1-4pm)
  â€¢ Weekend Learning (Sat/Sun 10am-12pm)

  The skill is built on top of the calendar skill, typecheck passes, and all cha
  nges have been committed.
