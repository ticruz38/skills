â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # Ralph Agent Instructions                                                   â”‚
â”‚                                                                              â”‚
â”‚ You are an autonomous coding agent working on a software project.            â”‚
â”‚                                                                              â”‚
â”‚ ## ğŸ›¡ï¸ CRITICAL SAFETY RULES - NEVER VIOLATE                                   â”‚
â”‚                                                                              â”‚
â”‚ ### System Resource Protection                                               â”‚
â”‚ The following actions are **STRICTLY PROHIBITED** and will cause harm to the â”‚
â”‚ host system:                                                                 â”‚
â”‚                                                                              â”‚
â”‚ **Docker/Container Management:**                                             â”‚
â”‚ - **NEVER** run `docker stop` without an explicit container name or ID       â”‚
â”‚ - **NEVER** use `docker stop $(docker ps -q)` or any pattern that stops mult â”‚
â”‚ iple/all containers                                                          â”‚
â”‚ - **NEVER** run `docker rm -f $(docker ps -aq)` or similar mass-removal comm â”‚
â”‚ ands                                                                         â”‚
â”‚ - **ALWAYS** verify container names with `docker ps --filter name=<pattern>` â”‚
â”‚ before stopping                                                              â”‚
â”‚ - **ONLY** stop containers that were explicitly created by this session      â”‚
â”‚ - **ONLY** stop containers using their explicit name: `docker stop <exact-co â”‚
â”‚ ntainer-name>`                                                               â”‚
â”‚                                                                              â”‚
â”‚ **Process Management:**                                                      â”‚
â”‚ - **NEVER** run `killall`, `pkill`, or similar commands without specific pro â”‚
â”‚ cess names                                                                   â”‚
â”‚ - **NEVER** use `kill -9` on system processes or processes you didn't start  â”‚
â”‚ - **ONLY** terminate processes you explicitly started in this session        â”‚
â”‚                                                                              â”‚
â”‚ **Port/Network Conflicts:**                                                  â”‚
â”‚ - If a port is in use, **USE A DIFFERENT PORT** instead of killing the proce â”‚
â”‚ ss using it                                                                  â”‚
â”‚ - Check what's running on a port with `lsof -i :<port>` or `ss -tlnp | grep  â”‚
â”‚ <port>`                                                                      â”‚
â”‚ - Prefer random/high ports (e.g., `docker run -p 0:8080`) to avoid conflicts â”‚
â”‚                                                                              â”‚
â”‚ **General Safety:**                                                          â”‚
â”‚ - **NEVER** run commands that affect system-wide state unless explicitly req â”‚
â”‚ uired by the PRD                                                             â”‚
â”‚ - **NEVER** use wildcards or glob patterns with destructive commands (`rm`,  â”‚
â”‚ `kill`, `stop`)                                                              â”‚
â”‚ - When in doubt, be explicit and specific with resource names                â”‚
â”‚                                                                              â”‚
â”‚ ---                                                                          â”‚
â”‚                                                                              â”‚
â”‚ ## Your Task                                                                 â”‚
â”‚                                                                              â”‚
â”‚ 1. Read the PRD at `prd.json` (in the same directory as this file)           â”‚
â”‚ 2. Read the progress log at `progress.txt` (check Codebase Patterns section  â”‚
â”‚ first)                                                                       â”‚
â”‚ 3. Check you're on the correct branch from PRD `branchName`. If not, check i â”‚
â”‚ t out or create from main.                                                   â”‚
â”‚ 4. Pick the **highest priority** user story where `passes: false`            â”‚
â”‚ 5. Implement that single user story                                          â”‚
â”‚ 6. Run quality checks (e.g., typecheck, lint, test - use whatever your proje â”‚
â”‚ ct requires)                                                                 â”‚
â”‚ 7. Update AGENTS.md files if you discover reusable patterns (see below)      â”‚
â”‚ 8. If checks pass, commit ALL changes with message: `feat: [Story ID] - [Sto â”‚
â”‚ ry Title]`                                                                   â”‚
â”‚ 9. Update the PRD to set `passes: true` for the completed story              â”‚
â”‚ 10. Append your progress to `progress.txt`                                   â”‚
â”‚                                                                              â”‚
â”‚ ## Progress Report Format                                                    â”‚
â”‚                                                                              â”‚
â”‚ APPEND to progress.txt (never replace, always append):                       â”‚
â”‚ ```                                                                          â”‚
â”‚ ## [Date/Time] - [Story ID]                                                  â”‚
â”‚ - What was implemented                                                       â”‚
â”‚ - Files changed                                                              â”‚
â”‚ - **Learnings for future iterations:**                                       â”‚
â”‚   - Patterns discovered (e.g., "this codebase uses X for Y")                 â”‚
â”‚   - Gotchas encountered (e.g., "don't forget to update Z when changing W")   â”‚
â”‚   - Useful context (e.g., "the evaluation panel is in component X")          â”‚
â”‚ ---                                                                          â”‚
â”‚ ```                                                                          â”‚
â”‚                                                                              â”‚
â”‚ The learnings section is critical - it helps future iterations avoid repeati â”‚
â”‚ ng mistakes and understand the codebase better.                              â”‚
â”‚                                                                              â”‚
â”‚ ## Consolidate Patterns                                                      â”‚
â”‚                                                                              â”‚
â”‚ If you discover a **reusable pattern** that future iterations should know, a â”‚
â”‚ dd it to the `## Codebase Patterns` section at the TOP of progress.txt (crea â”‚
â”‚ te it if it doesn't exist). This section should consolidate the most importa â”‚
â”‚ nt learnings:                                                                â”‚
â”‚                                                                              â”‚
â”‚ ```                                                                          â”‚
â”‚ ## Codebase Patterns                                                         â”‚
â”‚ - Example: Use `sql<number>` template for aggregations                       â”‚
â”‚ - Example: Always use `IF NOT EXISTS` for migrations                         â”‚
â”‚ - Example: Export types from actions.ts for UI components                    â”‚
â”‚ ```                                                                          â”‚
â”‚                                                                              â”‚
â”‚ Only add patterns that are **general and reusable**, not story-specific deta â”‚
â”‚ ils.                                                                         â”‚
â”‚                                                                              â”‚
â”‚ ## Update AGENTS.md Files                                                    â”‚
â”‚                                                                              â”‚
â”‚ Before committing, check if any edited files have learnings worth preserving â”‚
â”‚ in nearby AGENTS.md files:                                                   â”‚
â”‚                                                                              â”‚
â”‚ 1. **Identify directories with edited files** - Look at which directories yo â”‚
â”‚ u modified                                                                   â”‚
â”‚ 2. **Check for existing AGENTS.md** - Look for AGENTS.md in those directorie â”‚
â”‚ s or parent directories                                                      â”‚
â”‚ 3. **Add valuable learnings** - If you discovered something future developer â”‚
â”‚ s/agents should know:                                                        â”‚
â”‚    - API patterns or conventions specific to that module                     â”‚
â”‚    - Gotchas or non-obvious requirements                                     â”‚
â”‚    - Dependencies between files                                              â”‚
â”‚    - Testing approaches for that area                                        â”‚
â”‚    - Configuration or environment requirements                               â”‚
â”‚                                                                              â”‚
â”‚ **Examples of good AGENTS.md additions:**                                    â”‚
â”‚ - "When modifying X, also update Y to keep them in sync"                     â”‚
â”‚ - "This module uses pattern Z for all API calls"                             â”‚
â”‚ - "Tests require the dev server running on PORT 3000"                        â”‚
â”‚ - "Field names must match the template exactly"                              â”‚
â”‚                                                                              â”‚
â”‚ **Do NOT add:**                                                              â”‚
â”‚ - Story-specific implementation details                                      â”‚
â”‚ - Temporary debugging notes                                                  â”‚
â”‚ - Information already in progress.txt                                        â”‚
â”‚                                                                              â”‚
â”‚ Only update AGENTS.md if you have **genuinely reusable knowledge** that woul â”‚
â”‚ d help future work in that directory.                                        â”‚
â”‚                                                                              â”‚
â”‚ ## Quality Requirements                                                      â”‚
â”‚                                                                              â”‚
â”‚ - ALL commits must pass your project's quality checks (typecheck, lint, test â”‚
â”‚ )                                                                            â”‚
â”‚ - Do NOT commit broken code                                                  â”‚
â”‚ - Keep changes focused and minimal                                           â”‚
â”‚ - Follow existing code patterns                                              â”‚
â”‚                                                                              â”‚
â”‚ ## Browser Testing (Required for Frontend Stories)                           â”‚
â”‚                                                                              â”‚
â”‚ For any story that changes UI, you MUST verify it works in the browser:      â”‚
â”‚                                                                              â”‚
â”‚ 1. Load the `dev-browser` skill                                              â”‚
â”‚ 2. Navigate to the relevant page                                             â”‚
â”‚ 3. Verify the UI changes work as expected                                    â”‚
â”‚ 4. Take a screenshot if helpful for the progress log                         â”‚
â”‚                                                                              â”‚
â”‚ A frontend story is NOT complete until browser verification passes.          â”‚
â”‚                                                                              â”‚
â”‚ ## Stop Condition                                                            â”‚
â”‚                                                                              â”‚
â”‚ After completing a user story, check if ALL stories have `passes: true`.     â”‚
â”‚                                                                              â”‚
â”‚ If ALL stories are complete and passing, reply with:                         â”‚
â”‚ <promise>COMPLETE</promise>                                                  â”‚
â”‚                                                                              â”‚
â”‚ If there are still stories with `passes: false`, end your response normally  â”‚
â”‚ (another iteration will pick up the next story).                             â”‚
â”‚                                                                              â”‚
â”‚ ## Important                                                                 â”‚
â”‚                                                                              â”‚
â”‚ - Work on ONE story per iteration                                            â”‚
â”‚ - Commit frequently                                                          â”‚
â”‚ - Keep CI green                                                              â”‚
â”‚ - Read the Codebase Patterns section in progress.txt before starting         â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
â€¢ Let me start by reading the PRD file and the progress log to understand what n
  eeds to be done.
â€¢ Used ReadFile (prd.json)
â€¢ Used ReadFile (progress.txt)
â€¢ The progress.txt file is longer than 1000 lines. Let me read the rest of it an
  d then identify the next story to work on.
â€¢ Let me continue reading the progress.txt file to get all the patterns and find
  the next story to work on:
â€¢ Used ReadFile (progress.txt)
â€¢ Used Shell (cd /root/code/skills && git branch)
â€¢ Let me continue reading the progress.txt file to see the remaining content:
â€¢ Let me continue reading the progress file and check which stories are remainin
  g:
â€¢ Used ReadFile (progress.txt)
â€¢ Used Shell (cd /root/code/skills && c...es": false' | grep '"id"')
â€¢ I can see that the remaining stories with passes: false are:

  â€¢ US-055: email-summarizer skill
  â€¢ US-056: showing-scheduler skill
  â€¢ US-057: pantry-tracker skill
  â€¢ US-058: diy-guides skill
  â€¢ US-059: review-monitor skill
  â€¢ US-060: saved-searches skill

  The highest priority one is US-055. Let me look at the PRD for this story and
  start implementing it.

  US-055: Create email-summarizer skill for thread summaries

  â€¢ Description: Summarize long email threads
  â€¢ Acceptance Criteria:
    â€¢ Thread summarization
    â€¢ Key points extraction
    â€¢ Action items
    â€¢ Adjustable length
    â€¢ Typecheck passes
  â€¢ Notes: Depends: email. Uses main model

  This skill depends on the email skill and uses the main model for summarizatio
  n. Let me check the existing email skill to understand its API, and look at si
  milar skills like summarizer and draft-responses for patterns.
â€¢ I can see there are 6 remaining stories to implement. The highest priority one
  is US-055: Create email-summarizer skill for thread summaries.

  Let me check the existing email skill and similar summarization skills for pat
  terns:
â€¢ Used Glob (skills/email/src/*.ts)
â€¢ Used Glob (skills/summarizer/src/*.ts)
â€¢ Used Glob (skills/draft-responses/src/*.ts)
â€¢ Let me read the key parts of the email skill and the summarizer skill to under
  stand the patterns.
â€¢ Used ReadFile (skills/email/src/index.ts)
â€¢ Used ReadFile (skills/summarizer/src/index.ts)
â€¢ Used ReadFile (skills/draft-responses/src/index.ts)
â€¢ Now I have a good understanding of the patterns used. Let me read more of the
  email skill to understand how to fetch thread data, and check a package.json f
  ile to understand the project structure.
â€¢ Let me read more of the email skill to understand thread fetching, and check e
  xisting skill configurations:
â€¢ Used ReadFile (skills/email/src/index.ts)
â€¢ Used ReadFile (skills/summarizer/package.json)
â€¢ Used ReadFile (skills/draft-responses/package.json)
â€¢ Now let me read more of the email skill to understand how to fetch a thread:
â€¢ Used ReadFile (skills/email/src/index.ts)
â€¢ Used ReadFile (skills/email/tsconfig.json)
â€¢ Now let me look at the thread fetching method in the email skill:
â€¢ Let me find the thread fetching method in the email skill:
â€¢ Used Grep (getThread|async thread)
â€¢ I now have a good understanding of the patterns. Now let me create the email-s
  ummarizer skill. The key features are:

  1. Summarize email threads
  2. Extract key points
  3. Extract action items
  4. Adjustable length (short/medium/long)
  5. Depends on email skill
  6. Uses SQLite for storage

  Let me create the skill now.
â€¢ Now I have a clear understanding of the patterns. Let me create the email-summ
  arizer skill:
â€¢ Used SetTodoList
  â€¢ Create email-summarizer package.json â†
  â€¢ Create email-summarizer tsconfig.json
  â€¢ Create email-summarizer src/index.ts
  â€¢ Create email-summarizer src/cli.ts
  â€¢ Create SKILL.md documentation
  â€¢ Create .gitignore
  â€¢ Run typecheck
  â€¢ Update prd.json
  â€¢ Commit changes
â€¢ Let me create the directory structure and start creating the files.
â€¢ Used Shell (mkdir -p /root/code/skill...ills/email-summarizer/src)
â€¢ Now let me create all the files for the email-summarizer skill:
â€¢ Used WriteFile (skills/email-summarizer/package.json)
â€¢ Used WriteFile (skills/email-summarizer/tsconfig.json)
â€¢ Used WriteFile (skills/email-summarizer/.gitignore)
â€¢ Now let me create the main index.ts file with the skill implementation. The em
  ail-summarizer skill needs to:

  1. Fetch email threads using the email skill
  2. Summarize the thread content
  3. Extract key points
  4. Extract action items
  5. Support adjustable length (short/medium/long)
  6. Store summaries in SQLite
â€¢ Used SetTodoList
  â€¢ Create email-summarizer package.json
  â€¢ Create email-summarizer tsconfig.json
  â€¢ Create email-summarizer src/index.ts â†
  â€¢ Create email-summarizer src/cli.ts
  â€¢ Create SKILL.md documentation
  â€¢ Create .gitignore
  â€¢ Run typecheck
  â€¢ Update prd.json
  â€¢ Commit changes
â€¢ Now let me create the main index.ts file. This will be a comprehensive impleme
  ntation with thread summarization, key points extraction, and action items det
  ection.
â€¢ Used WriteFile (skills/email-summarizer/src/index.ts)
â€¢ Now let me create the CLI file:
â€¢ Used SetTodoList
  â€¢ Create email-summarizer package.json
  â€¢ Create email-summarizer tsconfig.json
  â€¢ Create email-summarizer src/index.ts
  â€¢ Create email-summarizer src/cli.ts â†
  â€¢ Create SKILL.md documentation
  â€¢ Create .gitignore
  â€¢ Run typecheck
  â€¢ Update prd.json
  â€¢ Commit changes
â€¢ Now let me create the CLI file:
â€¢ Used WriteFile (skills/email-summarizer/src/cli.ts)
â€¢ Now let me create the SKILL.md documentation:
â€¢ Used SetTodoList
  â€¢ Create email-summarizer package.json
  â€¢ Create email-summarizer tsconfig.json
  â€¢ Create email-summarizer src/index.ts
  â€¢ Create email-summarizer src/cli.ts
  â€¢ Create SKILL.md documentation â†
  â€¢ Create .gitignore
  â€¢ Run typecheck
  â€¢ Update prd.json
  â€¢ Commit changes
â€¢ Now let me create the SKILL.md documentation file:
â€¢ Used WriteFile (skills/email-summarizer/SKILL.md)
â€¢ Now let me run the typecheck to make sure everything compiles correctly:
â€¢ Used SetTodoList
  â€¢ Create email-summarizer package.json
  â€¢ Create email-summarizer tsconfig.json
  â€¢ Create email-summarizer src/index.ts
  â€¢ Create email-summarizer src/cli.ts
  â€¢ Create SKILL.md documentation
  â€¢ Create .gitignore
  â€¢ Run typecheck â†
  â€¢ Update prd.json
  â€¢ Commit changes
â€¢ Let me run the typecheck now:
â€¢ Used Shell (cd /root/code/skills/skil...rizer && npm install 2>&1)
â€¢ Good, dependencies installed. Now let me run the typecheck:
â€¢ Used Shell (cd /root/code/skills/skil...&& npm run typecheck 2>&1)
â€¢ Typecheck passes. Now let me update the prd.json to mark the story as complete
  , then commit the changes:
â€¢ Used SetTodoList
  â€¢ Create email-summarizer package.json
  â€¢ Create email-summarizer tsconfig.json
  â€¢ Create email-summarizer src/index.ts
  â€¢ Create email-summarizer src/cli.ts
  â€¢ Create SKILL.md documentation
  â€¢ Create .gitignore
  â€¢ Run typecheck
  â€¢ Update prd.json â†
  â€¢ Commit changes
â€¢ Now let me update the prd.json to mark US-055 as complete:
â€¢ Used StrReplaceFile (prd.json)
â€¢ Now let me update the progress.txt file with the learnings from this story:
â€¢ Used WriteFile (progress.txt)
â€¢ Now let me commit the changes:
â€¢ Used SetTodoList
  â€¢ Create email-summarizer package.json
  â€¢ Create email-summarizer tsconfig.json
  â€¢ Create email-summarizer src/index.ts
  â€¢ Create email-summarizer src/cli.ts
  â€¢ Create SKILL.md documentation
  â€¢ Create .gitignore
  â€¢ Run typecheck
  â€¢ Update prd.json
  â€¢ Commit changes â†
â€¢ Now let me commit the changes:
â€¢ Used Shell (cd /root/code/skills && git add -A && git status)
â€¢ Good, the changes are staged. Now let me commit them:
â€¢ Used Shell (cd /root/code/skills && g...ill for thread summaries")
â€¢ The commit was successful. Let me update the todo list and verify the work is
  done:
â€¢ Used SetTodoList
  â€¢ Create email-summarizer package.json
  â€¢ Create email-summarizer tsconfig.json
  â€¢ Create email-summarizer src/index.ts
  â€¢ Create email-summarizer src/cli.ts
  â€¢ Create SKILL.md documentation
  â€¢ Create .gitignore
  â€¢ Run typecheck
  â€¢ Update prd.json
  â€¢ Commit changes
â€¢ Let me verify the remaining stories to see if there are more to complete:
â€¢ Used Shell (cd /root/code/skills && c...es": false' | grep '"id"')
â€¢ I have successfully completed US-055 (email-summarizer skill). There are still
  5 more stories remaining:

  â€¢ US-056: showing-scheduler skill
  â€¢ US-057: pantry-tracker skill
  â€¢ US-058: diy-guides skill
  â€¢ US-059: review-monitor skill
  â€¢ US-060: saved-searches skill

  Since there are still stories with passes: false, I should end my response nor
  mally without the <promise>COMPLETE</promise> tag, indicating that another ite
  ration will pick up the next story.
â€¢ I have successfully completed US-055: Create email-summarizer skill for thread
  summaries.

  Summary of Changes

  Files Created

  â€¢ skills/email-summarizer/package.json - Package configuration with email skil
    dependency
  â€¢ skills/email-summarizer/tsconfig.json - TypeScript configuration
  â€¢ skills/email-summarizer/.gitignore - Git ignore rules
  â€¢ skills/email-summarizer/SKILL.md - Documentation
  â€¢ skills/email-summarizer/src/index.ts - Main library with:
    â€¢ Thread summarization (short/medium/long lengths)
    â€¢ Key points extraction using sentence scoring
    â€¢ Action item detection with regex patterns
    â€¢ SQLite storage for summary history
  â€¢ skills/email-summarizer/src/cli.ts - CLI interface with commands:
    â€¢ summarize <threadId> - Summarize a thread
    â€¢ history - View summary history
    â€¢ get <id> - Get specific summary
    â€¢ stats - Show statistics
    â€¢ health - Check system health

  Files Modified

  â€¢ prd.json - Updated US-055 passes: true
  â€¢ progress.txt - Added implementation details and learnings

  Key Features Implemented

  1. Thread Summarization: Extracts concise summaries from email threads with co
     gurable length (short/medium/long)
  2. Key Points Extraction: Uses sentence scoring algorithm based on email keywo
     , position, and content
  3. Action Items: Pattern matching to detect tasks, deadlines, and follow-ups w
     priority levels
  4. Multiple Formats: Paragraph, bullet points, or numbered list output
  5. History Tracking: SQLite storage for all generated summaries

  Quality Checks

  â€¢ âœ… TypeScript typecheck passes
  â€¢ âœ… All code committed with message: feat: US-055 - Create email-summarizer s
    ll for thread summaries

  There are 5 remaining stories to complete: US-056 through US-060.
