â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # Ralph Agent Instructions                                                   â”‚
â”‚                                                                              â”‚
â”‚ You are an autonomous coding agent working on a software project.            â”‚
â”‚                                                                              â”‚
â”‚ ## ğŸ›¡ï¸ CRITICAL SAFETY RULES - NEVER VIOLATE                                   â”‚
â”‚                                                                              â”‚
â”‚ ### System Resource Protection                                               â”‚
â”‚ The following actions are **STRICTLY PROHIBITED** and will cause harm to the â”‚
â”‚ host system:                                                                 â”‚
â”‚                                                                              â”‚
â”‚ **Docker/Container Management:**                                             â”‚
â”‚ - **NEVER** run `docker stop` without an explicit container name or ID       â”‚
â”‚ - **NEVER** use `docker stop $(docker ps -q)` or any pattern that stops mult â”‚
â”‚ iple/all containers                                                          â”‚
â”‚ - **NEVER** run `docker rm -f $(docker ps -aq)` or similar mass-removal comm â”‚
â”‚ ands                                                                         â”‚
â”‚ - **ALWAYS** verify container names with `docker ps --filter name=<pattern>` â”‚
â”‚ before stopping                                                              â”‚
â”‚ - **ONLY** stop containers that were explicitly created by this session      â”‚
â”‚ - **ONLY** stop containers using their explicit name: `docker stop <exact-co â”‚
â”‚ ntainer-name>`                                                               â”‚
â”‚                                                                              â”‚
â”‚ **Process Management:**                                                      â”‚
â”‚ - **NEVER** run `killall`, `pkill`, or similar commands without specific pro â”‚
â”‚ cess names                                                                   â”‚
â”‚ - **NEVER** use `kill -9` on system processes or processes you didn't start  â”‚
â”‚ - **ONLY** terminate processes you explicitly started in this session        â”‚
â”‚                                                                              â”‚
â”‚ **Port/Network Conflicts:**                                                  â”‚
â”‚ - If a port is in use, **USE A DIFFERENT PORT** instead of killing the proce â”‚
â”‚ ss using it                                                                  â”‚
â”‚ - Check what's running on a port with `lsof -i :<port>` or `ss -tlnp | grep  â”‚
â”‚ <port>`                                                                      â”‚
â”‚ - Prefer random/high ports (e.g., `docker run -p 0:8080`) to avoid conflicts â”‚
â”‚                                                                              â”‚
â”‚ **General Safety:**                                                          â”‚
â”‚ - **NEVER** run commands that affect system-wide state unless explicitly req â”‚
â”‚ uired by the PRD                                                             â”‚
â”‚ - **NEVER** use wildcards or glob patterns with destructive commands (`rm`,  â”‚
â”‚ `kill`, `stop`)                                                              â”‚
â”‚ - When in doubt, be explicit and specific with resource names                â”‚
â”‚                                                                              â”‚
â”‚ ---                                                                          â”‚
â”‚                                                                              â”‚
â”‚ ## Your Task                                                                 â”‚
â”‚                                                                              â”‚
â”‚ 1. Read the PRD at `prd.json` (in the same directory as this file)           â”‚
â”‚ 2. Read the progress log at `progress.txt` (check Codebase Patterns section  â”‚
â”‚ first)                                                                       â”‚
â”‚ 3. Check you're on the correct branch from PRD `branchName`. If not, check i â”‚
â”‚ t out or create from main.                                                   â”‚
â”‚ 4. Pick the **highest priority** user story where `passes: false`            â”‚
â”‚ 5. Implement that single user story                                          â”‚
â”‚ 6. Run quality checks (e.g., typecheck, lint, test - use whatever your proje â”‚
â”‚ ct requires)                                                                 â”‚
â”‚ 7. Update AGENTS.md files if you discover reusable patterns (see below)      â”‚
â”‚ 8. If checks pass, commit ALL changes with message: `feat: [Story ID] - [Sto â”‚
â”‚ ry Title]`                                                                   â”‚
â”‚ 9. Update the PRD to set `passes: true` for the completed story              â”‚
â”‚ 10. Append your progress to `progress.txt`                                   â”‚
â”‚                                                                              â”‚
â”‚ ## Progress Report Format                                                    â”‚
â”‚                                                                              â”‚
â”‚ APPEND to progress.txt (never replace, always append):                       â”‚
â”‚ ```                                                                          â”‚
â”‚ ## [Date/Time] - [Story ID]                                                  â”‚
â”‚ - What was implemented                                                       â”‚
â”‚ - Files changed                                                              â”‚
â”‚ - **Learnings for future iterations:**                                       â”‚
â”‚   - Patterns discovered (e.g., "this codebase uses X for Y")                 â”‚
â”‚   - Gotchas encountered (e.g., "don't forget to update Z when changing W")   â”‚
â”‚   - Useful context (e.g., "the evaluation panel is in component X")          â”‚
â”‚ ---                                                                          â”‚
â”‚ ```                                                                          â”‚
â”‚                                                                              â”‚
â”‚ The learnings section is critical - it helps future iterations avoid repeati â”‚
â”‚ ng mistakes and understand the codebase better.                              â”‚
â”‚                                                                              â”‚
â”‚ ## Consolidate Patterns                                                      â”‚
â”‚                                                                              â”‚
â”‚ If you discover a **reusable pattern** that future iterations should know, a â”‚
â”‚ dd it to the `## Codebase Patterns` section at the TOP of progress.txt (crea â”‚
â”‚ te it if it doesn't exist). This section should consolidate the most importa â”‚
â”‚ nt learnings:                                                                â”‚
â”‚                                                                              â”‚
â”‚ ```                                                                          â”‚
â”‚ ## Codebase Patterns                                                         â”‚
â”‚ - Example: Use `sql<number>` template for aggregations                       â”‚
â”‚ - Example: Always use `IF NOT EXISTS` for migrations                         â”‚
â”‚ - Example: Export types from actions.ts for UI components                    â”‚
â”‚ ```                                                                          â”‚
â”‚                                                                              â”‚
â”‚ Only add patterns that are **general and reusable**, not story-specific deta â”‚
â”‚ ils.                                                                         â”‚
â”‚                                                                              â”‚
â”‚ ## Update AGENTS.md Files                                                    â”‚
â”‚                                                                              â”‚
â”‚ Before committing, check if any edited files have learnings worth preserving â”‚
â”‚ in nearby AGENTS.md files:                                                   â”‚
â”‚                                                                              â”‚
â”‚ 1. **Identify directories with edited files** - Look at which directories yo â”‚
â”‚ u modified                                                                   â”‚
â”‚ 2. **Check for existing AGENTS.md** - Look for AGENTS.md in those directorie â”‚
â”‚ s or parent directories                                                      â”‚
â”‚ 3. **Add valuable learnings** - If you discovered something future developer â”‚
â”‚ s/agents should know:                                                        â”‚
â”‚    - API patterns or conventions specific to that module                     â”‚
â”‚    - Gotchas or non-obvious requirements                                     â”‚
â”‚    - Dependencies between files                                              â”‚
â”‚    - Testing approaches for that area                                        â”‚
â”‚    - Configuration or environment requirements                               â”‚
â”‚                                                                              â”‚
â”‚ **Examples of good AGENTS.md additions:**                                    â”‚
â”‚ - "When modifying X, also update Y to keep them in sync"                     â”‚
â”‚ - "This module uses pattern Z for all API calls"                             â”‚
â”‚ - "Tests require the dev server running on PORT 3000"                        â”‚
â”‚ - "Field names must match the template exactly"                              â”‚
â”‚                                                                              â”‚
â”‚ **Do NOT add:**                                                              â”‚
â”‚ - Story-specific implementation details                                      â”‚
â”‚ - Temporary debugging notes                                                  â”‚
â”‚ - Information already in progress.txt                                        â”‚
â”‚                                                                              â”‚
â”‚ Only update AGENTS.md if you have **genuinely reusable knowledge** that woul â”‚
â”‚ d help future work in that directory.                                        â”‚
â”‚                                                                              â”‚
â”‚ ## Quality Requirements                                                      â”‚
â”‚                                                                              â”‚
â”‚ - ALL commits must pass your project's quality checks (typecheck, lint, test â”‚
â”‚ )                                                                            â”‚
â”‚ - Do NOT commit broken code                                                  â”‚
â”‚ - Keep changes focused and minimal                                           â”‚
â”‚ - Follow existing code patterns                                              â”‚
â”‚                                                                              â”‚
â”‚ ## Browser Testing (Required for Frontend Stories)                           â”‚
â”‚                                                                              â”‚
â”‚ For any story that changes UI, you MUST verify it works in the browser:      â”‚
â”‚                                                                              â”‚
â”‚ 1. Load the `dev-browser` skill                                              â”‚
â”‚ 2. Navigate to the relevant page                                             â”‚
â”‚ 3. Verify the UI changes work as expected                                    â”‚
â”‚ 4. Take a screenshot if helpful for the progress log                         â”‚
â”‚                                                                              â”‚
â”‚ A frontend story is NOT complete until browser verification passes.          â”‚
â”‚                                                                              â”‚
â”‚ ## Stop Condition                                                            â”‚
â”‚                                                                              â”‚
â”‚ After completing a user story, check if ALL stories have `passes: true`.     â”‚
â”‚                                                                              â”‚
â”‚ If ALL stories are complete and passing, reply with:                         â”‚
â”‚ <promise>COMPLETE</promise>                                                  â”‚
â”‚                                                                              â”‚
â”‚ If there are still stories with `passes: false`, end your response normally  â”‚
â”‚ (another iteration will pick up the next story).                             â”‚
â”‚                                                                              â”‚
â”‚ ## Important                                                                 â”‚
â”‚                                                                              â”‚
â”‚ - Work on ONE story per iteration                                            â”‚
â”‚ - Commit frequently                                                          â”‚
â”‚ - Keep CI green                                                              â”‚
â”‚ - Read the Codebase Patterns section in progress.txt before starting         â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
â€¢ Let me start by reading the PRD and progress files to understand what needs to
  be done.
â€¢ Used ReadFile (prd.json)
â€¢ Used ReadFile (progress.txt)
â€¢ I've examined the PRD and the progress log. US-001 and US-002 are marked compl
  ete, so I'll skip those. US-003, "Create binance-auth skill for trading API,"
  is the highest-priority item where passes is false.

  The requirements for this skill are specific: I need to implement a secure API
  key storage mechanism, toggle between testnet and production environments, val
  idate API permissions, and set up a health check that queries account balances
  . This will likely involve extending the auth-provider's architecture to handl
  e HMAC-SHA256 signatures rather than standard OAuth flows.

  However, before I can define the structure or start coding, I need to see wher
  e this skill fits within the existing codebase. The PRD suggests a modular ski
  ll system. I need to verify the directory naming conventions and see if there
  are any existing "binance" related stubs I should be aware of.

  Wait, I should also check the general skills/ directory to see the list of cur
  rently implemented or planned modules. This will ensure that binance-auth is p
  laced correctly and follows the established organizational pattern. I'll start
  by exploring the skills directory to get a clear view of the workspace.
â€¢ Let me check the current branch and explore the existing skill structure to un
  derstand the patterns better.
â€¢ Used Shell (cd /root/code/skills && g...current && ls -la skills/)
â€¢ Good, I'm on the correct branch ralph/all-skills. Now let me look at the exist
  ing auth-provider and google-oauth skills to understand the patterns I should
  follow for binance-auth.
â€¢ Used ReadFile (skills/auth-provider/src/types.ts)
â€¢ Used ReadFile (skills/auth-provider/src/providers/binance.ts)
â€¢ Used ReadFile (skills/auth-provider/SKILL.md)
â€¢ I have a solid grasp of the auth-provider structure now. To build the binance-
  auth skill, I need to follow the established architectural patterns. Wait, I s
  hould verify how these skills are actually being linkedâ€”is it through local fi
  le references, workspaces, or a specific import alias? I need to see the depen
  dency structure in package.json and how the main entry point exports its funct
  ionality.

  Actually, google-oauth is the best reference for this since it likely handles
  similar provider-specific logic and relies on the core auth service. By examin
  ing its package manifest and source index, I can ensure the new Binance skill
  integrates correctly without any circular dependencies. I'll start by checking
  these files in the google-oauth directory to establish a baseline for my imple
  mentation.
â€¢ Let me also look at the google-oauth skill structure to understand the pattern
  for dependent skills:
â€¢ Used ReadFile (skills/google-oauth/package.json)
â€¢ Used ReadFile (skills/google-oauth/src/index.ts)
â€¢ I've analyzed the existing auth-provider and its google-oauth implementation.
  The architecture for a new skill is clear: a package.json for dependencies, a
  tsconfig.json for build settings, a SKILL.md for documentation, and a src fold
  er containing the core logic.

  However, binance-auth has a unique requirement: it handles API Key/Secret pair
  s rather than standard OAuth 2.0 flows. This means the src/index.ts will focus
  on credential management and HMAC-SHA256 signature generation for Binance's se
  curity model. I also need a CLI utility in src/cli.ts for manual configuration
  and health checks.

  Wait, I should map out the implementation sequence to ensure I don't miss the
  SKILL.md or the specific tsconfig settings used in this repo. The most logical
  approach is to build the foundation first and then layer the specific Binance
  logic on top.

  I'll start by defining the project structure and dependencies in package.json,
  then move to the TypeScript configuration and source files. I'll formalize thi
  s roadmap now to guide the development process.
â€¢ Now I understand the patterns. Let me create the binance-auth skill. This will
  be a skill built on top of auth-provider for managing Binance API credentials.
â€¢ Used SetTodoList
  â€¢ Create binance-auth skill structure â†
  â€¢ Create package.json with auth-provider dependency
  â€¢ Create tsconfig.json
  â€¢ Create SKILL.md documentation
  â€¢ Create src/index.ts with BinanceAuthClient
  â€¢ Create src/cli.ts for CLI commands
  â€¢ Build and typecheck
  â€¢ Update PRD and progress.txt
â€¢ Let me create the binance-auth skill directory and all its files.
â€¢ Used Shell (mkdir -p /root/code/skills/skills/binance-auth/src)
â€¢ Now let me create all the necessary files for the binance-auth skill.
â€¢ Used WriteFile (skills/binance-auth/package.json)
â€¢ Used WriteFile (skills/binance-auth/tsconfig.json)
â€¢ Used WriteFile (skills/binance-auth/SKILL.md)
â€¢ Now let me create the main index.ts file with the BinanceAuthClient class.
â€¢ Used WriteFile (skills/binance-auth/src/index.ts)
â€¢ Now let me create the CLI file for the binance-auth skill.
â€¢ Used WriteFile (skills/binance-auth/src/cli.ts)
â€¢ Now I need to update the todo list and build/typecheck the project.
â€¢ Used SetTodoList
  â€¢ Create binance-auth skill structure
  â€¢ Create package.json with auth-provider dependency
  â€¢ Create tsconfig.json
  â€¢ Create SKILL.md documentation
  â€¢ Create src/index.ts with BinanceAuthClient
  â€¢ Create src/cli.ts for CLI commands
  â€¢ Build and typecheck â†
  â€¢ Update PRD and progress.txt
â€¢ Let me build and typecheck the binance-auth skill.
â€¢ Used Shell (cd /root/code/skills/skil...tall && npm run typecheck)
  Failed with exit code: 2
â€¢ Hmm, the compiler is flagging a type mismatch in the binance-auth skill. It se
  ems auth.getBinanceClient and auth.getApiKey are being treated as if they retu
  rn a Promise, but the code is using them as if they are synchronous.

  Wait, let me check the implementation. If these methods were recently updated
  to be async, then src/index.ts is missing several await keywords. This would e
  xplain why the subsequent property access is failing.

  I need to verify the method signatures in the auth-provider source code to be
  sure. I'll read the main index.ts for the auth-provider skill to see how these
  functions are defined.
â€¢ Used ReadFile (skills/auth-provider/src/index.ts)
â€¢ I see the issue. The getBinanceClient and getApiKey methods in auth-provider a
  re async, but I was using them synchronously. Let me fix the binance-auth/src/
  index.ts file.
â€¢ Used WriteFile (skills/binance-auth/src/index.ts)
â€¢ Now I need to update the CLI file to properly handle the async methods. The is
  Connected() method is now async, so I need to update all usages.
â€¢ Now let me update the CLI file to handle async methods properly:
â€¢ Used WriteFile (skills/binance-auth/src/cli.ts)
â€¢ Now let me run typecheck again to see if there are any more errors.
â€¢ Used Shell (cd /root/code/skills/skil...auth && npm run typecheck)
â€¢ Typecheck passes. Now let me build the project.
â€¢ Typecheck passes. Let me build the project:
â€¢ Used Shell (cd /root/code/skills/skil...nce-auth && npm run build)
â€¢ Build succeeded. Let me verify the build output and then update the PRD and pr
  ogress.txt.
â€¢ Used Shell (cd /root/code/skills/skil...ance-auth && ls -la dist/)
â€¢ The build is complete. Now I need to:

  1. Update the PRD to set passes: true for US-003
  2. Append progress to progress.txt
  3. Commit the changesLet me do that now.
â€¢ Build is successful. Now let me update the PRD and progress file:
â€¢ Used SetTodoList
  â€¢ Create binance-auth skill structure
  â€¢ Create package.json with auth-provider dependency
  â€¢ Create tsconfig.json
  â€¢ Create SKILL.md documentation
  â€¢ Create src/index.ts with BinanceAuthClient
  â€¢ Create src/cli.ts for CLI commands
  â€¢ Build and typecheck
  â€¢ Update PRD and progress.txt â†
â€¢ Now let me update the PRD to set US-003 to passes: true and append the progres
  s.
â€¢ Used StrReplaceFile (prd.json)
â€¢ Used StrReplaceFile (progress.txt)
â€¢ Now let me commit the changes.
â€¢ Used Shell (cd /root/code/skills && git add -A && git status)
â€¢ The git status shows that node_modules are being added. I should not commit no
  de_modules. Let me check if there's a .gitignore in the auth-provider and goog
  le-oauth skills to follow the same pattern.
â€¢ I see node_modules is being included. Let me add a .gitignore for the binance-
  auth skill following the pattern of other skills:
â€¢ Used Shell (cat /root/code/skills/ski...e_modules/\ndist/\n*.log")
â€¢ Let me create a .gitignore for binance-auth and remove node_modules and dist f
  rom staging, then commit only the source files.
â€¢ Used WriteFile (skills/binance-auth/.gitignore)
â€¢ Used Shell (cd /root/code/skills && g...rogress.txt && git status)
â€¢ Now let me commit the changes with the proper commit message format.
â€¢ Used Shell (cd /root/code/skills && g...th skill for trading API")
â€¢ The commit is done. Now let me update the todo list and verify the completed s
  tatus.
â€¢ Used SetTodoList
  â€¢ Create binance-auth skill structure
  â€¢ Create package.json with auth-provider dependency
  â€¢ Create tsconfig.json
  â€¢ Create SKILL.md documentation
  â€¢ Create src/index.ts with BinanceAuthClient
  â€¢ Create src/cli.ts for CLI commands
  â€¢ Build and typecheck
  â€¢ Update PRD and progress.txt
â€¢ Let me verify the PRD is correctly updated and check how many stories remain t
  o be done.
â€¢ Let me verify the PRD update and check remaining stories:
â€¢ Used Shell (cd /root/code/skills && g..."passes": false' prd.json)
â€¢ 3 stories are now complete (US-001, US-002, US-003), and 57 remain. Let me ver
  ify the PRD is properly updated by checking the US-003 section.
â€¢ Used Shell (cd /root/code/skills && g...'"id": "US-003"' prd.json)
â€¢ US-003 is now marked as passing. Let me verify the progress.txt file was updat
  ed properly.
â€¢ Used Shell (cd /root/code/skills && head -30 progress.txt)
â€¢ The progress.txt file has been correctly updated with the US-003 entry. Let me
  provide a summary of what was completed.
â€¢ I have successfully completed US-003 - Create binance-auth skill for trading A
  PI.

  Summary

  Created the binance-auth skill that provides Binance API authentication and ke
  y management for trading skills. The skill is built on top of the auth-provide
  r skill for secure credential storage.

  Files Created:

  â€¢ skills/binance-auth/package.json - Package configuration with auth-provider
    pendency
  â€¢ skills/binance-auth/tsconfig.json - TypeScript configuration
  â€¢ skills/binance-auth/SKILL.md - Documentation with usage examples
  â€¢ skills/binance-auth/src/index.ts - Main library with BinanceAuthClient class
  â€¢ skills/binance-auth/src/cli.ts - CLI for managing credentials
  â€¢ skills/binance-auth/.gitignore - Git ignore file

  Features Implemented:

  â€¢ âœ… Secure API key and secret storage (encrypted via auth-provider)
  â€¢ âœ… Support for testnet vs production environments
  â€¢ âœ… API permission validation (SPOT, MARGIN, FUTURES, etc.)
  â€¢ âœ… Health check with balance query
  â€¢ âœ… Multi-profile support for multiple Binance accounts
  â€¢ âœ… CLI commands: status, connect, health, list, validate, balance, disconnec

  Quality Checks:

  â€¢ âœ… Typecheck passes
  â€¢ âœ… Build succeeds
  â€¢ âœ… Committed with message: feat: US-003 - Create binance-auth skill for trad
    g API

  The PRD has been updated with passes: true for US-003, and progress has been l
  ogged to progress.txt.

  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  3 of 60 stories complete. 57 remaining.
